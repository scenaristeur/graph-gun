(self["webpackChunkgraph_gun"]=self["webpackChunkgraph_gun"]||[]).push([[375],{6375:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return l}});var r=function(){var t=this,e=t._self._c;return e("div",[e("input",{directives:[{name:"model",rawName:"v-model",value:t.roomValue,expression:"roomValue"}],attrs:{placeholder:"room"},domProps:{value:t.roomValue},on:{input:function(e){e.target.composing||(t.roomValue=e.target.value)}}}),e("button",{on:{click:t.setRoom}},[t._v("set room")])])},o=[],i=n(53),a=n.n(i),s=(n(2032),n(6727),n(9056),n(531),n(8822),n(3266),n(2223),{name:"ConfigView",data(){return{roomValue:"chat1"}},mounted(){let t=a()({localStorage:!1,peers:["https://spogg.herokuapp.com/gun","http://localhost:8765/gun","https://gun-manhattan.herokuapp.com/gun"]}),e=t.user().recall({sessionStorage:!0});this.$store.commit("setDb",t),this.$store.commit("setUser",e),e.get("alias").on((t=>{this.$store.commit("setUsername",t)})),t.on("auth",(async()=>{const t=await e.get("alias");console.log(`signed in as ${t}`),t.length>0?(this.$store.commit("setUsername",t),this.getMessages()):alert("signed in as "+t)}))},methods:{setRoom(){this.$store.commit("setRoom",this.roomValue),this.getMessages()},getMessages(){let t=[];""==this.room&&this.setRoom();var e={".":{">":new Date(+new Date-108e5).toISOString()},"-":1};this.$store.state.db.get(this.$store.state.room).map(e).once((async(e,n)=>{if(e){const o="#foo";var r={who:await this.$store.state.db.user(e).get("alias"),what:await window.SEA.decrypt(e.what,o)+"",when:a().state.is(e,"what"),id:n};r.what&&(t=[...t.slice(-100),r].sort(((t,e)=>t.when-e.when)),this.$store.commit("setMessages",t))}}))}},watch:{room(){this.roomValue=this.room,console.log("rv",this.roomValue)}},computed:{room(){return this.$store.state.room}}}),u=s,c=n(1001),f=(0,c.Z)(u,r,o,!1,null,null,null),l=f.exports},5787:function(t,e,n){var r=n(7976),o=TypeError;t.exports=function(t,e){if(r(e,t))return t;throw o("Incorrect invocation")}},4019:function(t){t.exports="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView},260:function(t,e,n){"use strict";var r,o,i,a=n(4019),s=n(9781),u=n(7854),c=n(614),f=n(111),l=n(2597),p=n(648),h=n(6330),d=n(8880),g=n(8052),y=n(3070).f,v=n(7976),w=n(9518),m=n(7674),b=n(5112),k=n(9711),A=n(9909),x=A.enforce,S=A.get,T=u.Int8Array,_=T&&T.prototype,D=u.Uint8ClampedArray,O=D&&D.prototype,E=T&&w(T),j=_&&w(_),$=Object.prototype,N=u.TypeError,R=b("toStringTag"),I=k("TYPED_ARRAY_TAG"),C="TypedArrayConstructor",B=a&&!!m&&"Opera"!==p(u.opera),U=!1,G={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},J={BigInt64Array:8,BigUint64Array:8},M=function(t){if(!f(t))return!1;var e=p(t);return"DataView"===e||l(G,e)||l(J,e)},P=function(t){var e=w(t);if(f(e)){var n=S(e);return n&&l(n,C)?n[C]:P(e)}},L=function(t){if(!f(t))return!1;var e=p(t);return l(G,e)||l(J,e)},H=function(t){if(L(t))return t;throw N("Target is not a typed array")},W=function(t){if(c(t)&&(!m||v(E,t)))return t;throw N(h(t)+" is not a typed array constructor")},F=function(t,e,n,r){if(s){if(n)for(var o in G){var i=u[o];if(i&&l(i.prototype,t))try{delete i.prototype[t]}catch(a){try{i.prototype[t]=e}catch(c){}}}j[t]&&!n||g(j,t,n?e:B&&_[t]||e,r)}},V=function(t,e,n){var r,o;if(s){if(m){if(n)for(r in G)if(o=u[r],o&&l(o,t))try{delete o[t]}catch(i){}if(E[t]&&!n)return;try{return g(E,t,n?e:B&&E[t]||e)}catch(i){}}for(r in G)o=u[r],!o||o[t]&&!n||g(o,t,e)}};for(r in G)o=u[r],i=o&&o.prototype,i?x(i)[C]=o:B=!1;for(r in J)o=u[r],i=o&&o.prototype,i&&(x(i)[C]=o);if((!B||!c(E)||E===Function.prototype)&&(E=function(){throw N("Incorrect invocation")},B))for(r in G)u[r]&&m(u[r],E);if((!B||!j||j===$)&&(j=E.prototype,B))for(r in G)u[r]&&m(u[r].prototype,j);if(B&&w(O)!==j&&m(O,j),s&&!l(j,R))for(r in U=!0,y(j,R,{get:function(){return f(this)?this[I]:void 0}}),G)u[r]&&d(u[r],I,r);t.exports={NATIVE_ARRAY_BUFFER_VIEWS:B,TYPED_ARRAY_TAG:U&&I,aTypedArray:H,aTypedArrayConstructor:W,exportTypedArrayMethod:F,exportTypedArrayStaticMethod:V,getTypedArrayConstructor:P,isView:M,isTypedArray:L,TypedArray:E,TypedArrayPrototype:j}},9671:function(t,e,n){var r=n(9974),o=n(8361),i=n(7908),a=n(6244),s=function(t){var e=1==t;return function(n,s,u){var c,f,l=i(n),p=o(l),h=r(s,u),d=a(p);while(d-- >0)if(c=p[d],f=h(c,d,l),f)switch(t){case 0:return c;case 1:return d}return e?-1:void 0}};t.exports={findLast:s(0),findLastIndex:s(1)}},8544:function(t,e,n){var r=n(7293);t.exports=!r((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}))},3678:function(t){t.exports={IndexSizeError:{s:"INDEX_SIZE_ERR",c:1,m:1},DOMStringSizeError:{s:"DOMSTRING_SIZE_ERR",c:2,m:0},HierarchyRequestError:{s:"HIERARCHY_REQUEST_ERR",c:3,m:1},WrongDocumentError:{s:"WRONG_DOCUMENT_ERR",c:4,m:1},InvalidCharacterError:{s:"INVALID_CHARACTER_ERR",c:5,m:1},NoDataAllowedError:{s:"NO_DATA_ALLOWED_ERR",c:6,m:0},NoModificationAllowedError:{s:"NO_MODIFICATION_ALLOWED_ERR",c:7,m:1},NotFoundError:{s:"NOT_FOUND_ERR",c:8,m:1},NotSupportedError:{s:"NOT_SUPPORTED_ERR",c:9,m:1},InUseAttributeError:{s:"INUSE_ATTRIBUTE_ERR",c:10,m:1},InvalidStateError:{s:"INVALID_STATE_ERR",c:11,m:1},SyntaxError:{s:"SYNTAX_ERR",c:12,m:1},InvalidModificationError:{s:"INVALID_MODIFICATION_ERR",c:13,m:1},NamespaceError:{s:"NAMESPACE_ERR",c:14,m:1},InvalidAccessError:{s:"INVALID_ACCESS_ERR",c:15,m:1},ValidationError:{s:"VALIDATION_ERR",c:16,m:0},TypeMismatchError:{s:"TYPE_MISMATCH_ERR",c:17,m:1},SecurityError:{s:"SECURITY_ERR",c:18,m:1},NetworkError:{s:"NETWORK_ERR",c:19,m:1},AbortError:{s:"ABORT_ERR",c:20,m:1},URLMismatchError:{s:"URL_MISMATCH_ERR",c:21,m:1},QuotaExceededError:{s:"QUOTA_EXCEEDED_ERR",c:22,m:1},TimeoutError:{s:"TIMEOUT_ERR",c:23,m:1},InvalidNodeTypeError:{s:"INVALID_NODE_TYPE_ERR",c:24,m:1},DataCloneError:{s:"DATA_CLONE_ERR",c:25,m:1}}},9518:function(t,e,n){var r=n(2597),o=n(614),i=n(7908),a=n(6200),s=n(8544),u=a("IE_PROTO"),c=Object,f=c.prototype;t.exports=s?c.getPrototypeOf:function(t){var e=i(t);if(r(e,u))return e[u];var n=e.constructor;return o(n)&&e instanceof n?n.prototype:e instanceof c?f:null}},4590:function(t,e,n){var r=n(3002),o=RangeError;t.exports=function(t,e){var n=r(t);if(n%e)throw o("Wrong offset");return n}},3002:function(t,e,n){var r=n(9303),o=RangeError;t.exports=function(t){var e=r(t);if(e<0)throw o("The argument can't be less than 0");return e}},2262:function(t,e,n){"use strict";var r=n(2109),o=n(7908),i=n(6244),a=n(9303),s=n(1223);r({target:"Array",proto:!0},{at:function(t){var e=o(this),n=i(e),r=a(t),s=r>=0?r:n+r;return s<0||s>=n?void 0:e[s]}}),s("at")},4506:function(t,e,n){"use strict";var r=n(2109),o=n(1702),i=n(4488),a=n(9303),s=n(1340),u=n(7293),c=o("".charAt),f=u((function(){return"\ud842"!=="ð ®·".at(-2)}));r({target:"String",proto:!0,forced:f},{at:function(t){var e=s(i(this)),n=e.length,r=a(t),o=r>=0?r:n+r;return o<0||o>=n?void 0:c(e,o)}})},8675:function(t,e,n){"use strict";var r=n(260),o=n(6244),i=n(9303),a=r.aTypedArray,s=r.exportTypedArrayMethod;s("at",(function(t){var e=a(this),n=o(e),r=i(t),s=r>=0?r:n+r;return s<0||s>=n?void 0:e[s]}))},2958:function(t,e,n){"use strict";var r=n(260),o=n(9671).findLastIndex,i=r.aTypedArray,a=r.exportTypedArrayMethod;a("findLastIndex",(function(t){return o(i(this),t,arguments.length>1?arguments[1]:void 0)}))},3408:function(t,e,n){"use strict";var r=n(260),o=n(9671).findLast,i=r.aTypedArray,a=r.exportTypedArrayMethod;a("findLast",(function(t){return o(i(this),t,arguments.length>1?arguments[1]:void 0)}))},3462:function(t,e,n){"use strict";var r=n(7854),o=n(6916),i=n(260),a=n(6244),s=n(4590),u=n(7908),c=n(7293),f=r.RangeError,l=r.Int8Array,p=l&&l.prototype,h=p&&p.set,d=i.aTypedArray,g=i.exportTypedArrayMethod,y=!c((function(){var t=new Uint8ClampedArray(2);return o(h,t,{length:1,0:3},1),3!==t[1]})),v=y&&i.NATIVE_ARRAY_BUFFER_VIEWS&&c((function(){var t=new l(2);return t.set(1),t.set("2",1),0!==t[0]||2!==t[1]}));g("set",(function(t){d(this);var e=s(arguments.length>1?arguments[1]:void 0,1),n=u(t);if(y)return o(h,this,n,e);var r=this.length,i=a(n),c=0;if(i+e>r)throw f("Wrong length");while(c<i)this[e+c]=n[c++]}),!y||v)},1118:function(t,e,n){n(2958)},7380:function(t,e,n){n(3408)},2801:function(t,e,n){"use strict";var r=n(2109),o=n(7854),i=n(5005),a=n(9114),s=n(3070).f,u=n(2597),c=n(5787),f=n(9587),l=n(6277),p=n(3678),h=n(7741),d=n(9781),g=n(1913),y="DOMException",v=i("Error"),w=i(y),m=function(){c(this,b);var t=arguments.length,e=l(t<1?void 0:arguments[0]),n=l(t<2?void 0:arguments[1],"Error"),r=new w(e,n),o=v(e);return o.name=y,s(r,"stack",a(1,h(o.stack,1))),f(r,this,m),r},b=m.prototype=w.prototype,k="stack"in v(y),A="stack"in new w(1,2),x=w&&d&&Object.getOwnPropertyDescriptor(o,y),S=!!x&&!(x.writable&&x.configurable),T=k&&!S&&!A;r({global:!0,constructor:!0,forced:g||T},{DOMException:T?m:w});var _=i(y),D=_.prototype;if(D.constructor!==_)for(var O in g||s(D,"constructor",a(1,_)),p)if(u(p,O)){var E=p[O],j=E.s;u(_,j)||s(_,j,a(6,E.c))}},1661:function(t){function e(t){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}e.keys=function(){return[]},e.resolve=e,e.id=1661,t.exports=e},6727:function(t,e,n){t=n.nmd(t),function(){function e(t,r){return r?n(1661)(t):t.slice?e[o(t)]:function(n,r){t(n={exports:{}}),e[o(r)]=n.exports};function o(t){return t.split("/").slice(-1).toString().replace(".js","")}}var r=t;e((function(t){"undefined"!==typeof window&&(t.window=window);var e=t.window||t,n=e.AXE||function(){};(n.window=t.window)&&(n.window.AXE=n);try{"undefined"!==typeof r&&(r.exports=n)}catch(o){}t.exports=n}))(e,"./root"),e((function(t){var n=e("./root"),r=(n.window||"").Gun||e("./gun",1);(r.AXE=n).GUN=n.Gun=r;if(!r.window)try{e("./lib/axe",1)}catch(i){}function o(t){if(!t.axe){var e=t.opt,n=e.peers;if(!1!==e.axe&&("undefined"===typeof process||"false"!==""+({NODE_ENV:"production",BASE_URL:"/graph-gun/"}||0).AXE)&&r.window){var o,i;t.axe={};o=n[i="http://localhost:8765/gun"]=n[i]||{},o.id=o.url=i,o.retry=o.retry||0,r.log.once("AXE","AXE enabled: Trying to find network via (1) local peer (2) last used peers (3) hard coded peers."),r.log.once("AXEWarn","Warning: AXE alpha became super slow & laggy, now in testing only mode!");var a=JSON.parse((localStorage||"")[(e.file||"")+"axe/"]||null)||{};Object.keys(a.peers||"").forEach((function(t){o=n[i=t]=n[i]||{},o.id=o.url=i})),o=n[i="https://guntest.herokuapp.com/gun"]=n[i]||{},o.id=o.url=i;var s=e.mesh=e.mesh||r.Mesh(t);s.way=function(n){if(t.$===n.$||(n._||"").via)s.say(n,e.peers);else{var r=(n.$||"")._;if(r){if(n.get){if(r.axe)return;r.axe={}}s.say(n,e.peers)}else s.say(n,e.peers)}}}}}r.on("opt",(function(t){o(t),this.to.next(t)}));t.exports=n}))(e,"./axe")}()},53:function(t,e,n){t.exports=n(9220)},9220:function(t,e,n){t=n.nmd(t),n(4633),n(2262),n(4506),function(){function e(t,r){return r?n(1661)(t):t.slice?e[o(t)]:function(n,r){t(n={exports:{}}),e[o(r)]=n.exports};function o(t){return t.split("/").slice(-1).toString().replace(".js","")}}var r=t;e((function(t){String.random=function(t,e){var n="";t=t||24,e=e||"0123456789ABCDEFGHIJKLMNOPQRSTUVWXZabcdefghijklmnopqrstuvwxyz";while(t-- >0)n+=e.charAt(Math.floor(Math.random()*e.length));return n},String.match=function(t,e){var n,r;return"string"===typeof t&&("string"==typeof e&&(e={"=":e}),e=e||{},n=e["="]||e["*"]||e[">"]||e["<"],t===n||r===e["="]&&(n=e["*"]||e[">"],t.slice(0,(n||"").length)===n||r===e["*"]&&(r!==e[">"]&&r!==e["<"]?t>=e[">"]&&t<=e["<"]:r!==e[">"]&&t>=e[">"]||r!==e["<"]&&t<=e["<"])))},String.hash=function(t,e){if("string"===typeof t){if(e=e||0,!t.length)return e;for(var n,r=0,o=t.length;r<o;++r)n=t.charCodeAt(r),e=(e<<5)-e+n,e|=0;return e}};var e=Object.prototype.hasOwnProperty;Object.plain=function(t){return!!t&&(t instanceof Object&&t.constructor===Object||"Object"===Object.prototype.toString.call(t).match(/^\[object (\w+)\]$/)[1])},Object.empty=function(t,n){for(var r in t)if(e.call(t,r)&&(!n||-1==n.indexOf(r)))return!1;return!0},Object.keys=Object.keys||function(t){var n=[];for(var r in t)e.call(t,r)&&n.push(r);return n},function(){var t,e=setTimeout,n=0,r=0,o=typeof setImmediate!==""+t&&setImmediate||e;e.hold=e.hold||9,e.poll=e.poll||function(t){e.hold>=+new Date-n&&r++<3333?t():o((function(){n=+new Date,t()}),r=0)}}(),function(){var t,e=setTimeout,n=e.turn=e.turn||function(t){1==r.push(t)&&o(a)},r=n.s=[],o=e.poll,i=0,a=function(){(t=r[i++])&&t(),i!=r.length&&99!=i||(r=n.s=r.slice(i),i=0),r.length&&o(a)}}(),function(){var t,e=setTimeout,n=e.turn;(e.each=e.each||function(e,r,o,i){i=i||9,function a(s,u,c){if(u=(s=(e||[]).splice(0,i)).length){for(var f=0;f<u;f++)if(t!==(c=r(s[f])))break;if(t===c)return void n(a)}o&&o(c)}()})()}()}))(e,"./shim"),e((function(t){t.exports=function t(e,n,r){if(!e)return{to:t};var o,i="function"==typeof n;e=(this.tag||(this.tag={}))[e]||i&&(this.tag[e]={tag:e,to:t._={next:function(t){var e;(e=this.to)&&e.next(t)}}});if(i){var a={off:t.off||(t.off=function(){if(this.next===t._.next)return!0;this===this.the.last&&(this.the.last=this.back),this.to.back=this.back,this.next=t._.next,this.back.to=this.to,this.the.last===this.the&&delete this.on.tag[this.the.tag]}),to:t._,next:n,the:e,on:this,as:r};return(a.back=e.last||e).to=a,e.last=a}return(e=e.to)&&o!==n&&e.next(n),e}}))(e,"./onto"),e((function(t){t.exports=function(t){return null===t||"string"===typeof t||"boolean"===typeof t||"number"===typeof t&&t!=1/0&&t!=-1/0&&t===t||!!t&&"string"==typeof t["#"]&&1===Object.keys(t).length&&t["#"]}}))(e,"./valid"),e((function(t){function n(){var t=+new Date;return s<t?(i=0,s=t+n.drift):s=t+(i+=1)/a+n.drift}e("./shim"),n.drift=0;var r,o=-1/0,i=0,a=999,s=o;n.is=function(t,e,n){var r=e&&t&&t._&&t._[">"]||n;if(r)return"number"==typeof(r=r[e])?r:o},n.ify=function(t,e,n,o,i){(t=t||{})._=t._||{},i&&(t._["#"]=i);var a=t._[">"]||(t._[">"]={});return r!==e&&"_"!==e&&("number"==typeof n&&(a[e]=n),r!==o&&(t[e]=o)),t},t.exports=n}))(e,"./state"),e((function(t){function n(t){var e={s:{}},n=e.s;t=t||{max:999,age:9e3},e.check=function(t){return!!n[t]&&r(t)};var r=e.track=function(r){var o=n[r]||(n[r]={});return o.was=e.now=+new Date,e.to||(e.to=setTimeout(e.drop,t.age+9)),o};return e.drop=function(r){e.to=null,e.now=+new Date;var o=Object.keys(n);console.STAT&&console.STAT(e.now,+new Date-e.now,"dup drop keys"),setTimeout.each(o,(function(o){var i=n[o];i&&(r||t.age)>e.now-i.was||delete n[o]}),0,99)},e}e("./shim"),t.exports=n}))(e,"./dup"),e((function(t){e("./onto"),t.exports=function(t,e){if(this.on){var r=(this.opt||{}).lack||9e3;if("function"!=typeof t){if(!t)return;var o=t["#"]||t,i=(this.tag||"")[o];if(!i)return;return e&&(i=this.on(o,e),clearTimeout(i.err),i.err=setTimeout((function(){i.off()}),r)),!0}o=e&&e["#"]||n(9);if(!t)return o;var a=this.on(o,t,e);return a.err=a.err||setTimeout((function(){a.off(),a.next({err:"Error: No ACK yet.",lack:!0})}),r),o}};var n=String.random||function(){return Math.random().toString(36).slice(2)}}))(e,"./ask"),e((function(t){function n(t){return t instanceof n?(this._={$:this}).$:this instanceof n?n.create(this._={$:this,opt:t}):new n(t)}n.is=function(t){return t instanceof n||t&&t._&&t===t._.$||!1},n.version=.202,n.chain=n.prototype,n.chain.toJSON=function(){},e("./shim"),n.valid=e("./valid"),n.state=e("./state"),n.on=e("./onto"),n.dup=e("./dup"),n.ask=e("./ask"),function(){function t(r){if(r)if(r.out!==t){var o,i=this,a=i.as,u=a.at||a,c=u.$,f=u.dup,l=r.DBG;if((o=r["#"])||(o=r["#"]=s(9)),!f.check(o)){if(f.track(o),o=r._,r._="function"==typeof o?o:function(){},r.$&&r.$===(r.$._||"").$||(r.$=c),r["@"]&&!r.put&&h(r),!u.ask(r["@"],r)){if(l&&(l.u=+new Date),r.put)return void e(r);r.get&&n.on.get(r,c)}l&&(l.uc=+new Date),i.to.next(r),l&&(l.ua=+new Date),r.nts||r.NTS||(r.out=t,u.on("out",r),l&&(l.ue=+new Date))}}else this.to.next(r)}function e(e){if(e){var n=e._||"",i=n.root=((n.$=e.$||"")._||"").root;if(e["@"]&&n.faith&&!n.miss)return e.out=t,void i.on("out",e);n.latch=i.hatch,n.match=i.hatch=[];var s=e.put,f=n.DBG=e.DBG,l=+new Date;if(g=g||l,!s["#"]||!s["."]){f&&(f.p=l),n["#"]=e["#"],n.msg=e,n.all=0,n.stun=1;var p=Object.keys(s);console.STAT&&console.STAT(l,((f||n).pk=+new Date)-l,"put sort");var h,d,w,m,b,A,x,S=0;(function t(i){if(h!=S){if(h=S,!(w=p[S]))return console.STAT&&console.STAT(l,((f||n).pd=+new Date)-l,"put"),void a(n);(m=s[w])?(x=m._)?w!==x["#"]?A=y+v(w)+"soul not same.":(b=x[">"])||(A=y+v(w)+"no state."):A=y+v(w)+"no meta.":A=y+v(w)+"no node.",d=Object.keys(m||{})}if(A)return e.err=n.err=A,void a(n);var g,T=0;i=i||0;while(i++<9&&(g=d[T++]))if("_"!==g){var _=m[g],D=b[g];if(o===D){A=y+v(g)+"on"+v(w)+"no state.";break}if(!c(_)){A=y+v(g)+"on"+v(w)+"bad "+typeof _+v(_);break}r(_,g,w,D,e),++k}(d=d.slice(T)).length?u(t):(++S,d=null,t(i))})()}}}function r(t,e,n,o,i){var a,s=i._||"",u=s.root,c=u.graph,l=c[n]||p,h=f(l,e,1),d=l[e],g=s.DBG;(a=console.STAT)&&(c[n]&&d||(a.has=(a.has||0)+1));var y=b();if(o>y)return setTimeout((function(){r(t,e,n,o,i)}),(a=o-y)>m?m:a),void(console.STAT&&console.STAT((g||s).Hf=+new Date,a,"future"));if((!(o<h)||s.miss)&&(s.faith||o!==h||!(t===d||w(t)<=w(d))||s.miss)){s.stun++;var v=i["#"]+s.all++,k={toString:function(){return v},_:s};k.toJSON=k.toString,g&&(g.ph=g.ph||+new Date),u.on("put",{"#":k,"@":i["@"],put:{"#":n,".":e,":":t,">":o},_:s})}}function i(t){var e;(e=(t._||"").DBG)&&(e.pa=+new Date,e.pm=e.pm||+new Date);var n,r=this,o=r.as,i=o.graph,s=t._,u=t.put,c=u["#"],f=u["."],p=u[":"],h=u[">"];t["#"];(n=s.msg)&&(n=n.put)&&(n=n[c])&&l(n,f,h,p,c),i[c]=l(i[c],f,h,p,c),(n=(o.next||"")[c])&&n.on("in",t),a(s),r.to.next(t)}function a(e,n){var r;if(!e.stop&&(e.err||!(0<--e.stun))&&(e.stop=1,r=e.root)){var o=e.match;o.end=1,o===r.hatch&&(!(o=e.latch)||o.end?delete r.hatch:r.hatch=o),e.hatch&&e.hatch(),setTimeout.each(e.match,(function(t){t&&t()})),!(n=e.msg)||e.err||n.err||(n.out=t,e.root.on("out",n),A())}}function h(t){var e,n=t["@"]||"";(e=n._)&&(e.acks=(e.acks||0)+1,(e.err=t.err)&&(t["@"]=e["#"],a(e)),e.stop||e.crack||(e.crack=e.match&&e.match.push((function(){d(e)}))),d(e))}function d(t){t&&t.root&&(t.stun||t.acks!==t.all||t.root.on("in",{"@":t["#"],err:t.err,ok:t.err?o:{"":1}}))}n.create=function(e){e.root=e.root||e,e.graph=e.graph||{},e.on=e.on||n.on,e.ask=e.ask||n.ask,e.dup=e.dup||n.dup();var r=e.$.opt(e.opt);return e.once||(e.on("in",t,e),e.on("out",t,e),e.on("put",i,e),n.on("create",e),e.on("create",e)),e.once=1,r},n.on.put=e;var g,y="Error: Invalid graph!",v=function(t){return" '"+(""+t).slice(0,9)+"...' "},w=JSON.stringify,m=2147483647,b=n.state,k=0,A=function(){k>999&&k/-(g-(g=+new Date))>1&&(n.window&&console.log("Warning: You're syncing 1K+ records a second, faster than DOM can update - consider limiting query."),A=function(){k=0})}}(),function(){function t(t,e){var n=+new Date,r=t._||{},i=r.DBG=t.DBG,a=t["#"],u=s(9),c=Object.keys(e||"").sort(),p=((e||"")._||"")["#"],h=(c.length,t.$._.root),d=e===h.graph[p];console.STAT&&console.STAT(n,((i||r).gk=+new Date)-n,"got keys"),e&&function t(){n=+new Date;var r,g,y,v=0,w={};while(v<9&&(r=c[v++]))l(w,r,f(e,r),e[r],p);c=c.slice(v),(g={})[p]=w,w=g,d&&(y=function(){},y.ram=y.faith=!0),g=c.length,console.STAT&&console.STAT(n,-(n-(n=+new Date)),"got copied some"),i&&(i.ga=+new Date),h.on("in",{"@":a,"#":u,put:w,"%":g?u=s(9):o,$:h.$,_:y,DBG:i}),console.STAT&&console.STAT(n,+new Date-n,"got in"),g&&setTimeout.turn(t)}(),e||h.on("in",{"@":t["#"]})}n.on.get=function(e,n){var r=n._,i=e.get,a=i["#"],s=r.graph[a],u=i["."],c=r.next||(r.next={}),p=(c[a],e._||{}),h=p.DBG=e.DBG;if(h&&(h.g=+new Date),!s)return r.on("get",e);if(u){if("string"!=typeof u||o===s[u])return r.on("get",e);s=l({},u,f(s,u),s[u],a)}s&&t(e,s),r.on("get",e)},n.on.get.ack=t}(),function(){n.chain.opt=function(t){t=t||{};var e=this,r=e._,o=t.peers||t;return Object.plain(t)||(t={}),Object.plain(r.opt)||(r.opt=t),"string"==typeof o&&(o=[o]),Object.plain(r.opt.peers)||(r.opt.peers={}),o instanceof Array&&(t.peers={},o.forEach((function(e){var n={};n.id=n.url=e,t.peers[e]=r.opt.peers[e]=r.opt.peers[e]||n}))),a(t,(function t(e){var n=this[e];this&&this.hasOwnProperty(e)||"string"==typeof n||Object.empty(n)?this[e]=n:(!n||n.constructor===Object||n instanceof Array)&&a(n,t)})),r.opt.from=t,n.on("opt",r),r.opt.uuid=r.opt.uuid||function(t){return n.state().toString(36).replace(".","")+String.random(t||12)},e}}();var o,i,a=function(t,e){Object.keys(t).forEach(e,t)},s=String.random,u=setTimeout.turn,c=n.valid,f=n.state.is,l=n.state.ify,p={};n.log=function(){return!n.log.off&&i.log.apply(i,arguments),[].slice.call(arguments).join(" ")},n.log.once=function(t,e,r){return(r=n.log.once)[t]=r[t]||0,r[t]++||n.log(e)},"undefined"!==typeof window&&((window.GUN=window.Gun=n).window=window);try{"undefined"!==typeof r&&(r.exports=n)}catch(h){}t.exports=n,(n.window||{}).console=(n.window||{}).console||{log:function(){}},(i=console).only=function(t,e){return i.only.i&&t===i.only.i&&i.only.i++&&(i.log.apply(i,arguments)||e)},n.log.once("welcome","Hello wonderful person! :) Thanks for using GUN, please ask for help on http://chat.gun.eco if anything takes you longer than 5min to figure out!")}))(e,"./root"),e((function(t){var n=e("./root");n.chain.back=function(t,e){if(t=t||1,-1===t||1/0===t)return this._.root.$;if(1===t)return(this._.back||this._).$;var n=this,i=n._;if("string"===typeof t&&(t=t.split(".")),t instanceof Array){var a=0,s=t.length,u=i;for(a;a<s;a++)u=(u||o)[t[a]];return r!==u?e?n:u:(u=i.back)?u.$.back(t,e):void 0}if("function"==typeof t){var c;u={back:i};while((u=u.back)&&r===(c=t(u,e)));return c}return"number"==typeof t?(i.back||i).$.back(t-1):this};var r,o={}}))(e,"./back"),e((function(t){var n=e("./root");function r(t){var e,n,r=this.as,o=r.back,i=r.root;if(t.$||(t.$=r.$),this.to.next(t),!r.err){if(e=t.get){if(i.pass&&(i.pass[r.id]=r),r.lex&&Object.keys(r.lex).forEach((function(t){n[t]=r.lex[t]}),n=t.get=t.get||{}),e["#"]||r.soul){if(e["#"]=e["#"]||r.soul,t["#"]||(t["#"]=f(9)),o=i.$.get(e["#"])._,e=e["."]){if(p(o.put,e)&&(n=o.ask&&o.ask[e],(o.ask||(o.ask={}))[e]=o.$.get(e)._,o.on("in",{get:e,put:{"#":o.soul,".":e,":":o.put[e],">":d(i.graph[o.soul],e)}}),n))return}else{if(n=o.ask&&o.ask[""],(o.ask||(o.ask={}))[""]=o,u!==o.put&&(o.on("in",o),n))return;t.$=o.$}return i.ask(s,t),i.on("in",t)}if(e["."])return r.get?(t={get:{".":r.get},$:r.$},(o.ask||(o.ask={}))[r.get]=t.$._,o.on("out",t)):(t={get:r.lex?t.get:{},$:r.$},o.on("out",t));if((r.ask||(r.ask={}))[""]=r,r.get)return e["."]=r.get,(o.ask||(o.ask={}))[r.get]=t.$._,o.on("out",t)}return o.on("out",t)}r.on("in",{put:r.put=u,$:r.$})}function o(t,e){e=e||this.as;var n,r=e.root,o=t.$||(t.$=e.$),s=(o||"")._||c,f=t.put||"",p=f["#"],h=f["."],y=u!==f["="]?f["="]:f[":"],v=f[">"]||-1/0;if(u!==t.put&&(u===f["#"]||u===f["."]||u===f[":"]&&u===f["="]||u===f[">"]))return l(f)?void e.on("in",{$:s.back.$,put:{"#":p=s.back.soul,".":h=s.has||s.get,"=":f,">":d(s.back.put,h)},via:t}):(p=((f||"")._||"")["#"])?(o=e.root.$.get(p),setTimeout.each(Object.keys(f).sort(),(function(n){"_"!=n&&u!==(v=d(f,n))&&e.on("in",{$:o,put:{"#":p,".":n,"=":f[n],">":v},VIA:t})}))):void console.log("chain not yet supported for",f,"...",t,e);(t.seen||"")[e.id]||((t.seen||(t.seen=function(){}))[e.id]=e,e!==s&&(Object.keys(t).forEach((function(e){f[e]=t[e]}),f={}),f.get=e.get||f.get,e.soul||e.has?s.soul&&(f.$=e.$,f.$$=f.$$||s.$):f.$$$=f.$$$||e.$,t=f),a(t,e),(e.soul||t.$$)&&v>=d(r.graph[p],h)&&((f=r.$.get(p)._).put=g(f.put,h,v,y,p)),!s.soul&&v>=d(r.graph[p],h)&&(n=(r.$.get(p)._.next||"")[h])&&(n.put=y,"string"==typeof(f=l(y))&&(n.put=r.$.get(f)._.put||y)),this.to&&this.to.next(t),e.any&&setTimeout.each(Object.keys(e.any),(function(n){(n=e.any[n])&&n(t)}),0,99),e.echo&&setTimeout.each(Object.keys(e.echo),(function(n){(n=e.echo[n])&&n.on("in",t)}),0,99),((t.$$||"")._||s).soul&&(n=e.next)&&(n=n[h])&&(f={},Object.keys(t).forEach((function(e){f[e]=t[e]})),f.$=(t.$$||t.$).get(f.get=h),delete f.$$,delete f.$$$,n.on("in",f)),i(t,e))}function i(t,e){if(e=e||this.as||t.$._,(!t.$$||this===n.on)&&t.put&&!e.soul){var r=t.put||"",o=r["="]||r[":"],i=e.root,a=i.$.get(r["#"]).get(r["."])._;if("string"==typeof(o=l(o))){if(!(a.echo||(a.echo={}))[e.id]||(i.pass||"")[e.id]){if(u=i.pass){if(u[o+e.id])return;u[o+e.id]=1}(a.echo||(a.echo={}))[e.id]=e,e.has&&(e.link=o);var s=i.$.get(a.link=o)._;(s.echo||(s.echo={}))[a.id]=a;var u=e.ask||"";(u[""]||e.lex)&&s.on("out",{get:{"#":o}}),setTimeout.each(Object.keys(u),(function(t,e){t&&(e=u[t])&&e.on("out",{get:{"#":o,".":t}})}),0,99)}}else this===n.on&&((a.echo||(a.echo={}))[e.id]=e)}}function a(t,e){var n,r,o=t.put||"",i=u!==o["="]?o["="]:o[":"],s=e.root;if(u===i){if(e.soul&&u!==e.put)return;if(r=(t.$$||t.$||"")._||"",t["@"]&&(u!==r.put||u!==e.put))return;return(n=e.link||t.linked)&&delete(s.$.get(n)._.echo||"")[e.id],e.has&&(e.link=null),e.put=u,void setTimeout.each(Object.keys(e.next||""),(function(t,r){(r=e.next[t])&&(n&&delete(s.$.get(n).get(t)._.echo||"")[r.id],r.on("in",{get:t,put:u,$:r.$}))}),0,99)}e.soul||t.$$||(n=l(i),r=t.$._||"",(n!==r.link&&(!e.has||r.link)||(s.pass||"")[e.id]&&"string"!==typeof n)&&(delete(r.echo||"")[e.id],a({get:e.get,put:u,$:t.$,linked:t.linked=t.linked||r.link},e)))}function s(t,e){var r=this.as,o=r.$._,i=(o.root,r.get||""),a=(t.put||"")[i["#"]]||"";if(!t.put||"string"==typeof i["."]&&u===a[i["."]]){if(u!==o.put)return;if(!o.soul&&!o.has)return;return o.ack=(o.ack||0)+1,void o.on("in",{get:o.get,put:o.put=u,$:o.$,"@":t["@"]})}(t._||{}).miss=1,n.on.put(t)}n.chain.chain=function(t){var e,r=this,o=r._,i=new(t||r).constructor(r),a=i._;return a.root=e=o.root,a.id=++e.once,a.back=r._,a.on=n.on,a.on("in",n.on.in,a),a.on("out",n.on.out,a),i},n.on.out=r,n.on.in=o,n.on.link=i,n.on.unlink=a;var u,c={},f=String.random,l=n.valid,p=function(t,e){return t&&Object.prototype.hasOwnProperty.call(t,e)},h=n.state,d=h.is,g=h.ify}))(e,"./chain"),e((function(t){var n=e("./root");function r(t,e){var n=e._,r=n.next,o=e.chain(),i=o._;return r||(r=n.next={}),r[i.get=t]=i,e===n.root.$?i.soul=t:(n.soul||n.has)&&(i.has=t),i}function o(t,e,r,o){var i,s=t._,u=0;return(i=s.soul||s.link)?e(i,o,s):s.jam?s.jam.push([e,o]):(s.jam=[[e,o]],t.get((function(t,e){if(!(a===t.put&&!s.root.opt.super&&(i=Object.keys(s.root.opt.peers).length)&&++u<=i)){e.rid(t);var r,o=(o=t.$)&&o._||{},c=0;i=s.jam,delete s.jam;while(r=i[c++]){var f=r[0];r=r[1],f&&f(o.link||o.soul||n.valid(t.put)||((t.put||{})._||{})["#"],r,t,e)}}}),{out:{get:{".":!0}}}),t)}function i(t){var e=this.at||this.on;if(!t||e.soul||e.has)return this.off();if(t=(t=(t=t.$||t)._||t).id){var n;e.map;if((n=this.seen||(this.seen={}))[t])return!0;n[t]=!0}}n.chain.get=function(t,e,c){var f,l;if("string"===typeof t){if(0==t.length)return(f=this.chain())._.err={err:n.log("0 length key!",t)},e&&e.call(f,f._.err),f;var p=this,h=p._,d=h.next||s;(f=d[t])||(f=t&&r(t,p)),f=f&&f.$}else{if("function"==typeof t){if(!0===e)return o(this,t,e,c),this;f=this;h=f._;var g,y=e||{},v=h.root;y.at=h,y.ok=t;var w={};function m(t,e,r){if(!m.stun&&(!(o=v.pass)||o[g])){var o,i=t.$._,s=(t.$$||"")._,u=(s||i).put,c=!i.has&&!i.soul,f={};if((c||a===u)&&(u=a===((o=t.put)||"")["="]?a===(o||"")[":"]?o:o[":"]:o["="]),"string"==typeof(o=n.valid(u))&&(u=a===(o=v.$.get(o)._.put)?y.not?a:u:o),!y.not||a!==u){if(a===y.stun){if((o=v.stun)&&o.on&&(h.$.back((function(t){if(o.on(""+t.id,f={}),(f.run||0)<m.id)return f})),!f.run&&o.on(""+i.id,f={}),!f.run&&s&&o.on(""+s.id,f={}),m.id>f.run&&(f.stun&&!f.stun.end||(f.stun=o.on("stun"),f.stun=f.stun&&f.stun.last),f.stun&&!f.stun.end)))return void((f.stun.add||(f.stun.add={}))[g]=function(){m(t,e,1)});if(a===u&&(r=0),(o=v.hatch)&&!o.end&&a===y.hatch&&!r){if(w[i.$._.id])return;return w[i.$._.id]=1,void o.push((function(){m(t,e,1)}))}w={}}if(v.pass){if(v.pass[g+i.id])return;v.pass[g+i.id]=1}y.on?y.ok.call(i.$,u,i.get,t,e||m):y.v2020?y.ok(t,e||m):(Object.keys(t).forEach((function(e){o[e]=t[e]}),o={}),t=o,t.put=u,y.ok.call(y.as,t,e||m))}}}return m.at=h,(h.any||(h.any={}))[g=String.random(7)]=m,m.off=function(){m.stun=1,h.any&&delete h.any[g]},m.rid=i,m.id=y.run||++v.once,l=v.pass,(v.pass={})[g]=1,y.out=y.out||{get:{}},h.on("out",y.out),v.pass=l,f}if("number"==typeof t)return this.get(""+t,e,c);if("string"==typeof(l=u(t)))return this.get(l,e,c);(l=this.get.next)&&(f=l(this,t))}return f?(e&&"function"==typeof e&&f.get(e,c),f):((f=this.chain())._.err={err:n.log("Invalid get request!",t)},e&&e.call(f,f._.err),f)};var a,s={},u=n.valid}))(e,"./get"),e((function(t){var n=e("./root");function r(t,e){if(e){e=(e._||"").id||e;var r,o=t.root.stun||(t.root.stun={on:n.on}),i={};t.stun||(t.stun=o.on("stun",(function(){}))),(r=o.on(""+e))&&r.the.last.next(i),i.run>=t.run||o.on(""+e,(function(e){if(t.stun.end)return this.off(),void this.to.next(e);e.run=e.run||t.run,e.stun=e.stun||t.stun}))}}function o(t){if(t.err)o.end(t.stun,t.root);else if(!t.todo.length&&!t.end&&Object.empty(t.wait)){t.end=1;var e,r=t.$.back(-1)._,i=r.root,a=r.ask((function(e){i.on("ack",e),e.err&&n.log(e),++s>(t.acks||0)&&this.off(),t.ack&&t.ack(e,this)}),t.opt),s=0,u=t.stun;(e=function(){u&&(o.end(u,i),setTimeout.each(Object.keys(u=u.add||""),(function(t){(t=u[t])&&t()})))}).hatch=e,t.via._.on("out",{put:t.out=t.graph,opt:t.opt,"#":a,_:e})}}function i(t){var e,n=t.via._;t.via=t.via.back((function(n){if(n.soul||!n.get)return n.$;e=t.data,(t.data={})[n.get]=e})),t.via&&t.via._.soul||(t.via=n.root.$.get(((t.data||"")._||"")["#"]||n.$.back("opt.uuid")())),t.via.put(t.data,t.ack,t)}function a(t,e){return t&&(e=t.constructor)&&e.name||typeof t}n.chain.put=function(t,e,u){var p=this,h=p._,d=h.root;u=u||{},u.root=h.root,u.run||(u.run=d.once),r(u,h.id),u.ack=u.ack||e,u.via=u.via||p,u.data=u.data||t,u.soul||(u.soul=h.soul||"string"==typeof e&&e);var g=u.state=u.state||n.state();return"function"==typeof t?(t((function(t){u.data=t,p.put(s,s,u)})),p):u.soul?(u.$=d.$.get(u.soul),u.todo=[{it:u.data,ref:u.$}],u.turn=u.turn||c,u.ran=u.ran||o,function t(){var e,i,s,c,p,h=u.todo,d=h.pop(),y=d.it;d.ref&&d.ref._.id;if(r(u,d.ref),(c=d.todo)&&(i=c.pop(),y=y[i],c.length&&h.push(d)),i&&(h.path||(h.path=[])).push(i),!(e=f(y))&&!(p=n.is(y))){if(!Object.plain(y))return void o.err(u,"Invalid data: "+a(y)+" at "+(u.via.back((function(t){t.get&&c.push(t.get)}),c=[])||c.join("."))+"."+(h.path||[]).join("."));var v=u.seen||(u.seen=[]),w=v.length;while(w--)if(y===(c=v[w]).it){e=y=c.link;break}}if(i&&e)d.node=l(d.node,i,g,y);else{if(!u.seen)return void o.err(u,"Data at root of graph must be a node (an object).");u.seen.push(s={it:y,link:{},todo:p?[]:Object.keys(y).sort().reverse(),path:(h.path||[]).slice(),up:d}),d.node=l(d.node,i,g,s.link),!p&&s.todo.length&&h.push(s);var m=u.seen.length;function b(t,e){var n=s.link["#"];e&&(e.off(),e.rid(t));var o=n||t.soul||(c=(t.$$||t.$)._||"").soul||c.link||((c=c.put||"")._||"")["#"]||c["#"]||((c=t.put||"")&&t.$$?c["#"]:(c["="]||c[":"]||"")["#"]);!n&&r(u,t.$),o||d.link["#"]?(o||(o=[],(t.$$||t.$).back((function(t){if(c=t.soul||t.link)return o.push(c);o.push(t.get)})),o=o.reverse().join("/")),s.link["#"]=o,!p&&(((u.graph||(u.graph={}))[o]=s.node||(s.node={_:{}}))._["#"]=o),delete u.wait[m],s.wait&&setTimeout.each(s.wait,(function(t){t&&t()})),u.ran(u)):(d.wait||(d.wait=[])).push((function(){b(t,e)}))}(u.wait||(u.wait={}))[m]="",c=(s.ref=p?y:i?d.ref.get(i):d.ref)._,(c=y&&(y._||"")["#"]||c.soul||c.link)?b({soul:c}):s.ref.get(b,{run:u.run,v2020:1,out:{get:{".":" "}}})}if(!h.length)return u.ran(u);u.turn(t)}(),p):(i(u),p)},o.end=function(t,e){t.end=u,t.the.to===t&&t===t.the.last&&delete e.stun,t.off()},o.err=function(t,e){(t.ack||u).call(t,t.out={err:t.err=n.log(e)}),t.ran(t)};var s,u=function(){},c=setTimeout.turn,f=n.valid,l=n.state.ify}))(e,"./put"),e((function(t){var n=e("./root");e("./chain"),e("./back"),e("./put"),e("./get"),t.exports=n}))(e,"./index"),e((function(t){var n=e("./index");function r(t,e,r){return n.log.once("valonce","Chainable val is experimental, its behavior and API may change moving forward. Please play with it and report bugs and ideas on how to improve it."),(r=t.chain())._.nix=t.once((function(t,e){r._.on("in",this._)})),r._.lex=t._.lex,r}n.chain.on=function(t,e,n,r){var o,i=this,a=i._;a.root;if("string"===typeof t)return e?(o=a.on(t,e,n||a,r),n&&n.$&&(n.subs||(n.subs=[])).push(o),i):a.on(t);var s=e;(s=!0===s?{change:!0}:s||{}).not=1,s.on=1;return i.get(t,s),i},n.chain.once=function(t,e){if(e=e||{},!t)return r(this,e);var i,a=this,s=a._,u=s.root,c=(s.put,String.random(7));return a.get((function(r,a,f,l){var p=this,h=p._,d=h.one||(h.one={});function g(y){h.has||h.soul||(h={put:r,get:a}),o===(i=h.put)&&(i=((f.$$||"")._||"").put),"string"!=typeof n.valid(i)||(i=u.$.get(i)._.put,i!==o||y)?l.stun||""!==d[c]&&(d[c]="",(s.soul||s.has)&&l.off(),t.call(p,i,h.get),clearTimeout(d[c])):d[c]=setTimeout((function(){g(1)}),e.wait||99)}l.stun||""!==d[c]&&(!0!==(i=n.valid(r))?"string"!=typeof i&&(clearTimeout((s.one||"")[c]),clearTimeout(d[c]),d[c]=setTimeout(g,e.wait||99)):g())}),{on:1}),a},n.chain.off=function(){var t,e=this,n=e._,r=n.back;if(r)return n.ack=0,(t=r.next)&&t[n.get]&&delete t[n.get],(t=r.ask)&&delete t[n.get],(t=r.put)&&delete t[n.get],(t=n.soul)&&delete r.root.graph[t],(t=n.map)&&Object.keys(t).forEach((function(e,n){n=t[e],n.link&&r.root.$.get(n.link).off()})),(t=n.next)&&Object.keys(t).forEach((function(e,n){n=t[e],n.$.off()})),n.on("off",{}),e};var o}))(e,"./on"),e((function(t){var n=e("./index"),r=n.chain.get.next;function o(t){this.to.next(t);var e,r=this.as,o=t.$,i=o._,a=t.put;(i.soul||t.$$)&&((e=r.lex)&&!String.match(t.get||(a||"")["."],e["."]||e["#"]||e)||n.on.link(t,r))}n.chain.get.next=function(t,e){var n;return Object.plain(e)?(n=((n=e["#"])||"")["="]||n)?t.get(n):((n=t.chain()._).lex=e,t.on("in",(function(t){String.match(t.get||(t.put||"")["."],e["."]||e["#"]||e)&&n.on("in",t),this.to.next(t)})),n.$):(r||a)(t,e)},n.chain.map=function(t,e,r){var s,u,c=this,f=c._;return Object.plain(t)&&(s=t["."]?t:{".":t},t=i),t?(n.log.once("mapfn","Map functions are experimental, their behavior and API may change moving forward. Please play with it and report bugs and ideas on how to improve it."),u=c.chain(),c.map().on((function(e,r,o,s){var c=(t||a).call(this,e,r,o,s);if(i!==c){if(e===c)return u._.on("in",o);if(n.is(c))return u._.on("in",c._);var f={};Object.keys(o.put).forEach((function(t){f[t]=o.put[t]}),f),f["="]=c,u._.on("in",{get:r,put:f})}})),u):((u=f.each)||((f.each=u=c.chain())._.lex=s||u._.lex||f.lex,u._.nix=c.back("nix"),c.on("in",o,u._)),u)};var i,a=function(){}}))(e,"./map"),e((function(t){var n=e("./index");n.chain.set=function(t,e,r){var o,i,a=this,s=a.back(-1);return e=e||function(){},r=r||{},r.item=r.item||t,(o=((t||"")._||"")["#"])&&((t={})["#"]=o),"string"==typeof(i=n.valid(t))?a.get(o=i).put(t,e,r):n.is(t)?(a.put((function(r){t.get((function(t,o,s){if(!t)return e.call(a,{err:n.log('Only a node can be linked! Not "'+s.put+'"!')});(i={})[t]={"#":t},r(i)}),!0)})),t):(Object.plain(t)&&(t=s.get(o=a.back("opt.uuid")()).put(t)),a.get(o||s.back("opt.uuid")(7)).put(t,e,r))}}))(e,"./set"),e((function(t){e("./shim");var n=function(){},r=JSON.parseAsync||function(t,e,n){var r,i=+new Date;try{e(r,JSON.parse(t,n),o.sucks(+new Date-i))}catch(a){e(a)}},o=JSON.stringifyAsync||function(t,e,n,r){var i,a=+new Date;try{e(i,JSON.stringify(t,n,r),o.sucks(+new Date-a))}catch(s){e(s)}};function i(t){var e=function(){},n=t.opt||{};n.log=n.log||console.log,n.gap=n.gap||n.wait||0,n.max=n.max||.3*(n.memory?999*n.memory*999:3e8),n.pack=n.pack||.01*n.max*.01,n.puff=n.puff||9;var i=setTimeout.turn||setTimeout,s=t.dup,u=s.check,c=s.track,f=(new Date,e.hear=function(t,o){if(t){if(n.max<=t.length)return e.say({dam:"!",err:"Message too big!"},o);e===this&&(f.d+=t.length||0,++f.c);var a,s=o.SH=+new Date,u=t[0];return"["===u?(r(t,(function(t,r){if(t||!r)return e.say({dam:"!",err:"DAM JSON parse error."},o);console.STAT&&console.STAT(+new Date,r.length,"# on hear batch");var a=n.puff;(function t(){var n,s=+new Date,u=0;while(u<a&&(n=r[u++]))e.hear(n,o);r=r.slice(u),console.STAT&&console.STAT(s,+new Date-s,"hear loop"),l(o),r.length&&i(t,0)})()})),void(t="")):"{"===u||(t["#"]||Object.plain(t))&&(a=t)?a?f.one(a,o,s):void r(t,(function(t,n){if(t||!n)return e.say({dam:"!",err:"DAM JSON parse error."},o);f.one(n,o,s)})):void 0}});f.one=function(n,r,o){var i,a,f,l,p;if(n.DBG&&(n.DBG=p={DBG:n.DBG}),p&&(p.h=o),p&&(p.hp=+new Date),(i=n["#"])||(i=n["#"]=String.random(9)),!(f=u(i))&&(a=n["##"],!(a&&(f=n["@"]||n.get&&i)&&s.check(l=f+a)))){if((n._=function(){}).via=e.leap=r,(f=n["><"])&&"string"==typeof f&&f.slice(0,99).split(",").forEach((function(t){this[t]=1}),n._.yo={}),f=n.dam)return(f=e.hear[f])&&f(n,r,t),void c(i);o=+new Date;p&&(p.is=o),r.SI=i,t.on("in",e.last=n),p&&(p.hd=+new Date),console.STAT&&console.STAT(o,+new Date-o,n.get?"msg get":n.put?"msg put":"msg"),(f=c(i)).via=r,n.get&&(f.it=n),l&&c(l),e.leap=e.last=null}};function l(t){var e=t.batch,r="string"==typeof e;if(r&&(e+="]"),t.batch=t.tail=null,e&&!(r?3>e.length:!e.length)){if(!r)try{e=1===e.length?e[0]:JSON.stringify(e)}catch(o){return n.log("DAM JSON stringify error",o)}e&&p(e,t)}}function p(t,n){try{var r=n.wire;n.say?n.say(t):r.send&&r.send(t),e.say.d+=t.length||0,++e.say.c}catch(o){(n.queue=n.queue||[]).push(t)}}f.c=f.d=0,function(){var t,r=0;function f(t,e){var n;return e instanceof Object?(Object.keys(e).sort().forEach(h,{to:n={},on:e}),n):e}function h(t){this.to[t]=this.on[t]}e.hash=function(t,n){var r,a,s,u=+new Date;o(t.put,(function o(c,f){var l=(a||(a=s=f||"")).slice(0,32768);r=String.hash(l,r),a=a.slice(32768),a?i(o,0):(console.STAT&&console.STAT(u,+new Date-u,"say json+hash"),t._.$put=s,t["##"]=r,e.say(t,n),delete t._.$put)}),f)};e.say=function(o,u){var f;if((f=this)&&(f=f.to)&&f.next&&f.next(o),!o)return!1;var h,d,g=o["@"],y=o._||(o._=function(){}),v=o.DBG,w=+new Date;if(y.y=y.y||w,u||v&&(v.y=w),(h=o["#"])||(h=o["#"]=String.random(9)),!t&&c(h),o.put&&(o.err||(s.s[h]||"").err))return!1;if(o["##"]||a===o.put||y.via||!g){if(!u&&g&&(u=(f=s.s[g])&&(f.via||(f=f.it)&&(f=f._)&&f.via)||(f=e.last)&&g===f["#"]&&e.leap),!u&&g){if(s.s[g])return;return console.STAT&&console.STAT(+new Date,++r,"total no peer to ack to"),!1}if(!u&&e.way)return e.way(o);if(v&&(v.yh=+new Date),d=y.raw){if(v&&(v.yr=+new Date),!u||!u.id){if(!Object.plain(u||n.peers))return!1;w=+new Date,n.puff;var m=n.peers,b=Object.keys(u||n.peers||{});return console.STAT&&console.STAT(w,+new Date-w,"peer keys"),void function n(){var r=+new Date;t=1;var a=y.raw;y.raw=d;var s,u=0;while(u<9&&(s=(b||"")[u++]))(s=m[s])&&e.say(o,s);y.raw=a,t=0,b=b.slice(u),console.STAT&&console.STAT(r,+new Date-r,"say loop"),b.length&&(i(n,0),g&&c(g))}()}if(!u.wire&&e.wire&&e.wire(u),h!==u.last){if(u.last=h,u===y.via)return!1;if((f=y.yo)&&(f[u.url]||f[u.pid]||f[u.id]))return!1;if(console.STAT&&console.STAT(w,((v||y).yp=+new Date)-(y.y||w),"say prep"),!t&&g&&c(g),u.batch){if(u.tail=(f=u.tail||0)+d.length,u.tail<=n.pack)return void(u.batch+=(f?",":"")+d);l(u)}u.batch="[";var k=+new Date;setTimeout((function(){console.STAT&&console.STAT(k,+new Date-k,"0ms TO"),l(u)}),n.gap),p(d,u),console.STAT&&g===u.SI&&console.STAT(w,+new Date-u.SH,"say ack")}}else e.raw(o,u)}else e.hash(o,u)};e.say.c=e.say.d=0,e.raw=function(t,r){if(!t)return"";var i,c,f=t._||{};if(c=f.raw)return c;if("string"==typeof t)return t;var l=t["##"],p=t["@"];if(l&&p){if(!f.via&&u(p+l))return!1;if((c=(s.s[p]||"").it)||(c=e.last)&&p===c["#"]){if(l===c["##"])return!1;c["##"]||(c["##"]=l)}}if(!t.dam){var h=0,d=[];for(var g in c=n.peers,c){var y=c[g];if(d.push(y.url||y.pid||y.id),++h>6)break}h>1&&(t["><"]=d.join())}if(i=f.$put)return c={},Object.keys(t).forEach((function(e){c[e]=t[e]})),c.put=":])([:",void o(c,(function(t,e){if(!t){var n=+new Date;c=e.indexOf('"put":":])([:"'),v(a,e=e.slice(0,c+6)+i+e.slice(c+14)),console.STAT&&console.STAT(n,+new Date-n,"say slice")}}));function v(n,o){n||(f.raw=o,e.say(t,r))}o(t,v)}}(),e.hi=function(r){var o,i=r.wire;i?(r.id?n.peers[r.url||r.id]=r:(o=r.id=r.id||String.random(9),e.say({dam:"?",pid:t.opt.pid},n.peers[o]=r),delete s.s[r.last]),r.met=r.met||+new Date,i.hied||t.on(i.hied="hi",r),o=r.queue,r.queue=[],setTimeout.each(o||[],(function(t){p(t,r)}),0,9)):e.wire(r.length&&{url:r}||r)},e.bye=function(n){t.on("bye",n);var r=+new Date;r-=n.met||r,e.bye.time=((e.bye.time||r)+r)/2},e.hear["!"]=function(t,e){n.log("Error:",t.err)},e.hear["?"]=function(t,r){t.pid&&(r.pid||(r.pid=t.pid),t["@"])||(e.say({dam:"?",pid:n.pid,"@":t["#"]},r),delete s.s[r.last])},t.on("create",(function(t){t.opt.pid=t.opt.pid||String.random(9),this.to.next(t),t.on("out",e.say)})),t.on("bye",(function(t,e){t=n.peers[t.id||t]||t,this.to.next(t),t.bye?t.bye():(e=t.wire)&&e.close&&e.close(),delete n.peers[t.id],t.wire=null}));var h={};return t.on("bye",(function(t,e){this.to.next(t),(e=console.STAT)&&(e.peers=(e.peers||0)-1),(e=t.url)&&(h[e]=!0,setTimeout((function(){delete h[e]}),n.lack||9e3))})),t.on("hi",(function(r,o){this.to.next(r),(o=console.STAT)&&(o.peers=(o.peers||0)+1),(o=r.url)&&h[o]&&(delete h[o],n.super||setTimeout.each(Object.keys(t.next),(function(n){t.next[n];o={},o[n]=t.graph[n],o=String.hash(o),e.say({"##":o,get:{"#":n}},r)})))})),e}o.sucks=function(t){t>99&&(console.log("Warning: JSON blocking CPU detected. Add `gun/lib/yson.js` to fix."),o.sucks=n)};var a;try{t.exports=i}catch(s){}}))(e,"./mesh"),e((function(t){var n=e("../index");n.Mesh=e("./mesh"),n.on("opt",(function(t){if(this.to.next(t),!t.once){var e=t.opt;if(!1!==e.WebSocket){var o=n.window||{},i=e.WebSocket||o.WebSocket||o.webkitWebSocket||o.mozWebSocket;if(i){e.WebSocket=i;var a=e.mesh=e.mesh||n.Mesh(t);a.wire||e.wire;a.wire=e.wire=c,setTimeout((function(){!e.super&&t.on("out",{dam:"hi"})}),1);var s=1998,u=""+r!==typeof document&&document}}}function c(t){try{if(!t||!t.url)return r&&r(t);var n=t.url.replace(/^http/,"ws"),r=t.wire=new e.WebSocket(n);return r.onclose=function(){e.mesh.bye(t),f(t)},r.onerror=function(e){f(t)},r.onopen=function(){e.mesh.hi(t)},r.onmessage=function(n){n&&e.mesh.hear(n.data||n,t)},r}catch(o){}}function f(t){clearTimeout(t.defer),e.peers[t.url]&&(u&&t.retry<=0||(t.retry=(t.retry||e.retry+1||60)-(-t.tried+(t.tried=+new Date)<4*s?1:0),t.defer=setTimeout((function e(){if(u&&u.hidden)return setTimeout(e,s);c(t)}),s)))}}));var r}))(e,"./websocket"),e((function(t){if("undefined"!==typeof Gun){var e,n=function(){};try{e=(Gun.window||n).localStorage}catch(o){}e||(Gun.log("Warning: No localStorage exists to persist data to!"),e={setItem:function(t,e){this[t]=e},removeItem:function(t){delete this[t]},getItem:function(t){return this[t]}});JSON.parseAsync;var r=JSON.stringifyAsync||function(t,e,n,r){var i;try{e(i,JSON.stringify(t,n,r))}catch(o){e(o)}};Gun.on("create",(function t(n){this.to.next(n);var i,a,s,u,c=n.opt,f=(n.graph,[]);if(!1!==c.localStorage){c.prefix=c.file||"gun/";try{i=t[c.prefix]=t[c.prefix]||JSON.parse(s=e.getItem(c.prefix))||{}}catch(o){i=t[c.prefix]={}}s=(s||"").length,n.on("get",(function(t){this.to.next(t);var e,n,r,o,a=t.get;a&&(e=a["#"])&&(n=i[e]||o,n&&(r=a["."])&&!Object.plain(r)&&(n=Gun.state.ify({},r,Gun.state.is(n,r),n[r],e)),Gun.on.get.ack(t,n))})),n.on("put",(function(t){this.to.next(t);var e=t.put,r=e["#"],o=e["."],c=t["#"];i[r]=Gun.state.ify(i[r],o,e[">"],e[":"],r),u&&s>4999880?n.on("in",{"@":c,err:"localStorage max!"}):(t["@"]||f.push(c),a||(a=setTimeout(l,9+s/333)))}))}function l(){if(f.length||!((setTimeout.turn||"").s||"").length){var t=f;clearTimeout(a),a=!1,f=[],r(i,(function(r,a){try{!r&&e.setItem(c.prefix,a)}catch(o){r=u=o||"localStorage failure"}r&&(Gun.log(r+" Consider using GUN's IndexedDB plugin for RAD for more storage space, https://gun.eco/docs/RAD#install"),n.on("localStorage:error",{err:r,get:c.prefix,put:i})),s=a.length,(r||Object.empty(c.peers))&&setTimeout.each(t,(function(t){n.on("in",{"@":t,err:r,ok:0})}),0,99)}))}else setTimeout(l,99)}}))}}))(e,"./localStorage")}(),function(){if(""+T!=typeof Gun){var t=function(t){console.warn("Warning! Deprecated internal utility will break in next version:",t)},e=Gun;e.fn=e.fn||{is:function(e){return t("fn"),!!e&&"function"==typeof e}},e.bi=e.bi||{is:function(e){return t("bi"),e instanceof Boolean||"boolean"==typeof e}},e.num=e.num||{is:function(e){return t("num"),!r(e)&&(e-parseFloat(e)+1>=0||1/0===e||-1/0===e)}},e.text=e.text||{is:function(e){return t("text"),"string"==typeof e}},e.text.ify=e.text.ify||function(n){return t("text.ify"),e.text.is(n)?n:"undefined"!==typeof JSON?JSON.stringify(n):n&&n.toString?n.toString():n},e.text.random=e.text.random||function(e,n){t("text.random");var r="";e=e||24,n=n||"0123456789ABCDEFGHIJKLMNOPQRSTUVWXZabcdefghijklmnopqrstuvwxyz";while(e>0)r+=n.charAt(Math.floor(Math.random()*n.length)),e--;return r},e.text.match=e.text.match||function(e,n){var r,o;return t("text.match"),"string"===typeof e&&("string"==typeof n&&(n={"=":n}),n=n||{},r=n["="]||n["*"]||n[">"]||n["<"],e===r||o===n["="]&&(r=n["*"]||n[">"]||n["<"],e.slice(0,(r||"").length)===r||o===n["*"]&&(o!==n[">"]&&o!==n["<"]?e>=n[">"]&&e<=n["<"]:o!==n[">"]&&e>=n[">"]||o!==n["<"]&&e<=n["<"])))},e.text.hash=e.text.hash||function(e,n){if(t("text.hash"),"string"===typeof e){if(n=n||0,!e.length)return n;for(var r,o=0,i=e.length;o<i;++o)r=e.charCodeAt(o),n=(n<<5)-n+r,n|=0;return n}},e.list=e.list||{is:function(e){return t("list"),e instanceof Array}},e.list.slit=e.list.slit||Array.prototype.slice,e.list.sort=e.list.sort||function(e){return t("list.sort"),function(t,n){return t&&n?(t=t[e],n=n[e],t<n?-1:t>n?1:0):0}},e.list.map=e.list.map||function(e,n,r){return t("list.map"),s(e,n,r)},e.list.index=1,e.obj=e.boj||{is:function(e){return t("obj"),!!e&&(e instanceof Object&&e.constructor===Object||"Object"===Object.prototype.toString.call(e).match(/^\[object (\w+)\]$/)[1])}},e.obj.put=e.obj.put||function(e,n,r){return t("obj.put"),(e||{})[n]=r,e},e.obj.has=e.obj.has||function(e,n){return t("obj.has"),e&&Object.prototype.hasOwnProperty.call(e,n)},e.obj.del=e.obj.del||function(e,n){if(t("obj.del"),e)return e[n]=null,delete e[n],e},e.obj.as=e.obj.as||function(e,n,r,o){return t("obj.as"),e[n]=e[n]||(o===r?{}:r)},e.obj.ify=e.obj.ify||function(e){if(t("obj.ify"),i(e))return e;try{e=JSON.parse(e)}catch(n){e={}}return e},function(){var n;function r(t,e){a(this,e)&&n!==this[e]||(this[e]=t)}e.obj.to=e.obj.to||function(e,n){return t("obj.to"),n=n||{},s(e,r,n),n}}(),e.obj.copy=e.obj.copy||function(e){return t("obj.copy"),e?JSON.parse(JSON.stringify(e)):e},function(){function n(t,e){var n,r=this.n;if(!r||!(e===r||i(r)&&a(r,e)))return n!==e||void 0}e.obj.empty=e.obj.empty||function(e,r){return t("obj.empty"),!e||!s(e,n,{n:r})}}(),function(){function n(t,e){if(2===arguments.length)return n.r=n.r||{},void(n.r[t]=e);n.r=n.r||[],n.r.push(t)}var o,s=Object.keys;Object.keys=Object.keys||function(t){return o(t,(function(t,e,n){n(e)}))},e.obj.map=o=e.obj.map||function(o,u,c){t("obj.map");var f,l,p,h,d,g=0,y="function"==typeof u;if(n.r=f,s&&i(o)&&(h=s(o),d=!0),c=c||{},r(o)||h)for(l=(h||o).length;g<l;g++){var v=g+e.list.index;if(y){if(p=d?u.call(c,o[h[g]],h[g],n):u.call(c,o[g],v,n),p!==f)return p}else if(u===o[d?h[g]:g])return h?h[g]:v}else for(g in o)if(y){if(a(o,g)&&(p=c?u.call(c,o[g],g,n):u(o[g],g,n),p!==f))return p}else if(u===o[g])return g;return y?n.r:e.list.index?0:-1}}(),e.time=e.time||{},e.time.is=e.time.is||function(e){return t("time"),e?e instanceof Date:+(new Date).getTime()};var n=e.fn.is,r=e.list.is,o=e.obj,i=o.is,a=o.has,s=o.map,u={is:function(e){return t("val.is"),e!==T&&(null===e||e!==1/0&&(!!(p(e)||f(e)||l(e))||(u.link.is(e)||!1)))}};u.link=u.rel={_:"#"},function(){function e(t,e){var n=this;return n.id?n.id=!1:e==c&&p(t)?void(n.id=t):n.id=!1}u.link.is=function(n){if(t("val.link.is"),n&&n[c]&&!n._&&i(n)){var r={};if(s(n,e,r),r.id)return r.id}return!1}}(),u.link.ify=function(e){return t("val.link.ify"),h({},c,e)},e.obj.has._=".";var c=u.link._,f=e.bi.is,l=e.num.is,p=e.text.is,h=(o=e.obj,i=o.is,o.put);s=o.map;e.val=e.val||u;var d={_:"_",soul:function(e,n){return t("node.soul"),e&&e._&&e._[n||w]}};d.soul.ify=function(e,n){return t("node.soul.ify"),n="string"===typeof n?{soul:n}:n||{},e=e||{},e._=e._||{},e._[w]=n.soul||e._[w]||v(),e},d.soul._=u.link._,function(){function e(t,e){if(e!==d._)return!u.is(t)||void(this.cb&&this.cb.call(this.as,t,e,this.n,this.s))}d.is=function(n,r,o){var a;return t("node.is"),!!i(n)&&(!!(a=d.soul(n))&&!s(n,e,{as:o,cb:r,s:a,n:n}))}}(),function(){function e(t,e){var n,r,o=this.o;if(o.map)return n=o.map.call(this.as,t,""+e,o.node),void(r===n?g(o.node,e):o.node&&(o.node[e]=n));u.is(t)&&(o.node[e]=t)}d.ify=function(n,r,o){return t("node.ify"),r?"string"===typeof r?r={soul:r}:"function"==typeof r&&(r={map:r}):r={},r.map&&(r.node=r.map.call(o,n,T,r.node||{})),(r.node=d.soul.ify(r.node||{},r))&&s(n,e,{o:r,as:o}),r.node}}();o=e.obj,i=o.is;var g=o.del,y=(s=o.map,e.text),v=y.random,w=d.soul._;e.node=e.node||d;var m=e.state;m.lex=function(){return t("state.lex"),m().toString(36).replace(".","")},m.to=function(e,n,r){t("state.to");var o=(e||{})[n];return i(o)&&(o=b(o)),m.ify(r,n,m.is(e,n),o,d.soul(e))},function(){function e(t,e){x!==e&&m.ify(this.o,e,this.s)}m.map=function(r,o,u){var c;t("state.map");var f=i(f=r||o)?f:null;return r=n(r=r||o)?r:null,f&&!r?(o=l(o)?o:m(),f[x]=f[x]||{},s(f,e,{o:f,s:o}),f):(u=u||i(o)?o:c,o=l(o)?o:m(),function(t,n,i,s){if(!r)return e.call({o:i,s:o},t,n),t;r.call(u||this||{},t,n,i,s),a(i,n)&&c===i[n]||e.call({o:i,s:o},t,n)})}}();o=e.obj,o.as,a=o.has,i=o.is,s=o.map;var b=o.copy,k=e.num,A=(l=k.is,e.fn),x=(n=A.is,d._),S={};(function(){function e(t,e){if(!t||e!==d.soul(t)||!d.is(t,this.fn,this.as))return!0;this.cb&&(n.n=t,n.as=this.as,this.cb.call(n.as,t,e,n))}function n(t){t&&d.is(n.n,t,n.as)}S.is=function(n,r,o,a){return t("graph.is"),!(!n||!i(n)||_(n))&&!s(n,e,{cb:r,fn:o,as:a})}})(),function(){function n(t,e){var n;return(n=c(t,e))?n:(e.env=t,e.soul=o,d.ify(e.obj,r,e)&&(e.link=e.link||u.link.ify(d.soul(e.node)),e.obj!==t.shell&&(t.graph[u.link.is(e.link)]=e.node)),e)}function r(t,e,r){var o,i,c=this,f=c.env;if(d._===e&&a(t,u.link._))return r._;if(o=s(t,e,r,c,f)){if(e||(c.node=c.node||r||{},a(t,d._)&&d.soul(t)&&(c.node._=b(t._)),c.node=d.soul.ify(c.node,u.link.is(c.link)),c.link=c.link||u.link.ify(d.soul(c.node))),(i=f.map)&&(i.call(f.as||{},t,e,r,c),a(r,e))){if(t=r[e],T===t)return void g(r,e);if(!(o=s(t,e,r,c,f)))return}if(!e)return c.node;if(!0===o)return t;if(i=n(f,{obj:t,path:c.path.concat(e)}),i.node)return i.link}}function o(t){var e=this,n=u.link.is(e.link),r=e.env.graph;e.link=e.link||u.link.ify(t),e.link[u.link._]=t,e.node&&e.node[d._]&&(e.node[d._][u.link._]=t),a(r,n)&&(r[t]=r[n],g(r,n))}function s(t,n,r,o,a){var c;return!!u.is(t)||(i(t)?1:(c=a.invalid)?(t=c.call(a.as||{},t,n,r),s(t,n,r,o,a)):(a.err="Invalid value at '"+o.path.concat(n).join(".")+"'!",void(e.list.is(t)&&(a.err+=" Use `.set(item)` instead of an Array."))))}function c(t,e){var n,r=t.seen,o=r.length;while(o--)if(n=r[o],e.obj===n.obj)return n;r.push(e)}S.ify=function(e,r,o){t("graph.ify");var i={path:[],obj:e};return r?"string"===typeof r?r={soul:r}:"function"==typeof r&&(r.map=r):r={},"string"===typeof o&&(r.soul=r.soul||o,o=T),r.soul&&(i.link=u.link.ify(r.soul)),r.shell=(o||{}).shell,r.graph=r.graph||{},r.seen=r.seen||[],r.as=r.as||o,n(r,i),r.root=i.node,r.graph}}(),S.node=function(e){t("graph.node");var n=d.soul(e);if(n)return h({},n,e)},function(){function e(t,e){var n,r;if(d._!==e)(n=u.link.is(t))?(r=this.opt.seen[n])?this.obj[e]=r:this.obj[e]=this.opt.seen[n]=S.to(this.graph,n,this.opt):this.obj[e]=t;else{if(_(t,u.link._))return;this.obj[e]=b(t)}}S.to=function(n,r,o){if(t("graph.to"),n){var i={};return o=o||{seen:{}},s(n[r],e,{obj:i,graph:n,opt:o}),i}}}();n=e.fn.is,o=e.obj,i=o.is,g=o.del,a=o.has;var T,_=o.empty;h=o.put,s=o.map,b=o.copy;e.graph=e.graph||S}}()},8822:function(t,e,n){n(4633),function(){function e(t){t=t||{},t.log=t.log||console.log,t.file=String(t.file||"radata");var i=(e.has||(e.has={}))[t.file];if(i)return i;function a(t){return encodeURIComponent(t).replace(/\*/g,"%2A")}function s(t){return g!==t&&(!t||"object"!=typeof t)}t.max=t.max||.3*(t.memory?999*t.memory*999:3e8),t.until=t.until||t.wait||250,t.batch=t.batch||1e4,t.chunk=t.chunk||1048576,t.code=t.code||{},t.code.from=t.code.from||"!",t.jsonify=!0;var u=""+g===typeof setImmediate?setTimeout:setImmediate,c=setTimeout.turn||u,f=o.object,l=0;if(!t.store)return t.log("ERROR: Radisk needs `opt.store` interface with `{get: fn, put: fn (, list: fn)}`!");if(!t.store.put)return t.log("ERROR: Radisk needs `store.put` interface with `(file, data, cb)`!");if(!t.store.get)return t.log("ERROR: Radisk needs `store.get` interface with `(file, cb)`!");t.store.list,""+g!="function"&&n(9056);var p=JSON.parseAsync||function(t,e,n){var r;try{e(r,JSON.parse(t,n))}catch(o){e(o)}},h=(JSON.stringifyAsync,function(t,e,n,r,o){if("function"===typeof e){var i=n||{};return n=e,void h.read(t,n,i,o||r)}h.save(t,e,n,r,o)});h.save=function(e,n,r,i,s){var u,c,f={key:e};f.find=function(e){var n;f.file=e||(e=t.code.from),s&&(s=s[e]=s[e]||{}),s&&(s.sf=s.sf||+new Date),(n=h.disk[e])?f.mix(g,n):h.parse(e,f.mix,g,s)},f.mix=function(a,u){if(s&&(s.sml=+new Date),s&&(s.sm=s.sm||+new Date),f.err=a||f.err)r(a);else{var c,l=f.file=(u||"").file||f.file;if(!u&&l!==t.code.from)return h.find.bad(l),void h.save(e,n,r,i);(u=h.disk[l]||(h.disk[l]=u||o())).file||(u.file=l),t.compare&&(n=t.compare(u(e),n,e,l),g===n)?r(a,-1):((f.disk=u)(e,n),i&&((c=(c=u.tags||(u.tags={}))[i]||(c[i]=h.tags[i]||(h.tags[i]={})))[l]||(c[l]=h.one[i]||(h.one[i]=r)),r=null),s&&(s.st=s.st||+new Date),u.Q?r&&u.Q.push(r):(u.Q=r?[r]:[],u.to=setTimeout(f.write,t.until)))}},f.write=function(){s&&(s.sto=s.sto||+new Date);var t=u=f.file,e=f.disk;c=f.q=e.Q,f.tags=e.tags,delete e.Q,delete h.disk[t],delete e.tags,h.write(t,e,f.ack,g,s)},f.ack=function(t,e){var n,r;for(var o in s&&(s.sa=s.sa||+new Date),s&&(s.sal=c.length),h.tags)if(h.tags.hasOwnProperty(o)){var i=h.tags[o];if(!((r=h.disk[u])&&(r=r.tags)&&r[i])){var l;for(var p in n=i[u],delete i[u],i)if(i.hasOwnProperty(p)){l=!0;break}l||(delete h.tags[i],n&&n(t,e))}}!c&&(c="");for(var d=c.length,g=0,y=+new Date;g<d;g++)(n=c[g])&&n(t,e);console.STAT&&console.STAT(y,+new Date-y,"rad acks",a(f.file)),console.STAT&&console.STAT(y,c.length,"rad acks #",a(f.file))},r||(r=function(t,e){}),h.find(e,f.find)},h.disk={},h.one={},h.tags={};var d=0;h.write=function(n,r,i,s,u){if(r){s="object"==typeof s?s:{force:s};var c,f,p=function(){};p.text="",p.file=n=r.file||(r.file=n),n?(p.write=function(){var e=r.raw=p.text;h.disk[n=r.file||p.file||n]=r;var o=+new Date;u&&(u.wd=o),h.find.add(n,(function(s){u&&(u.wa=+new Date),s?i(s):t.store.put(a(n),e,(function(t,e){u&&(u.wp=+new Date),console.STAT&&console.STAT(o,l=+new Date-o,"wrote disk",JSON.stringify(n),++d,"total all writes."),i(t,e||1),r.Q||delete h.disk[n]}))}))},p.split=function(){var t=+new Date;u&&(u.wf=t),p.text="",p.count||(p.count=0,o.map(r,(function(){p.count++}))),u&&(u.wfc=p.count),p.limit=Math.ceil(p.count/2);var e=p.count;return p.count=0,u&&(u.wf1=+new Date),p.sub=o(),o.map(r,p.slice,{reverse:1}),u&&(u.wf2=+new Date),h.write(p.end,p.sub,p.both,s),u&&(u.wf3=+new Date),p.hub=o(),o.map(r,p.stop),u&&(u.wf4=+new Date),h.write(r.file,p.hub,p.both,s),u&&(u.wf5=+new Date),console.STAT&&console.STAT(t,+new Date-t,"rad split",a(r.file),e),!0},p.slice=function(t,e){if(p.sub(p.end=e,t),p.limit<=++p.count)return!0},p.stop=function(t,e){if(e>=p.end)return!0;p.hub(e,t)},p.both=function(t,e){u&&(u.wfd=+new Date),f?i(t||f):c?i(t,e):(c=!0,f=t)},p.each=function(n,r,o,a){if(g!==n&&p.count++,t.max<=(n||"").length)return i("Data too big!"),!0;var u=e.encode(a.length)+"#"+e.encode(o)+(g===n?"":":"+e.encode(n))+"\n";if(t.chunk<p.text.length+u.length&&1<p.count&&!s.force)return p.split();p.text+=u},t.jsonify?h.write.jsonify(p,r,i,s,u):o.map(r,p.each,!0)||p.write()):i("What file?")}else i("No radix!")},h.write.jsonify=function(e,n,r,i,a){var s,u=+new Date;a&&(a.w=u);try{s=JSON.stringify(n.$)}catch(f){return void r("Cannot radisk!")}if(a&&(a.ws=+new Date),console.STAT&&console.STAT(u,+new Date-u,"rad stringified JSON"),t.chunk<s.length&&!i.force){var c=0;if(o.map(n,(function(){if(c++)return!0})),c>1)return e.split()}e.text=s,e.write()},h.range=function(t,e){if(t&&e){if(g===e.start&&g===e.end)return t;if(s(t))return t;var n=o();return o.map(t,(function(t,e){n(e,t)}),e),n("")}},function(){h.read=function(e,n,r,i){r=r||{};var s={key:e,find:function(e){var n;s.file=e||(e=t.code.from),i&&(i=i[e]=i[e]||{}),i&&(i.rf=i.rf||+new Date),(n=h.disk[s.file=e])?s.check(g,n):h.parse(e,s.check,g,i)},get:function(a,c,f){if(i&&(i.rgl=+new Date),i&&(i.rg=i.rg||+new Date),s.err=a||s.err)n(a);else{var l=s.file=(c||"").file||s.file;if(!c&&l!==t.code.from)return h.find.bad(l),void h.read(e,n,r);if(c=h.disk[l]||(h.disk[l]=c),c){c.file||(c.file=l);var p=h.range(c(e),r);if(i&&(i.rr=+new Date),r.unit=c.unit,r.chunks=(r.chunks||0)+1,r.parsed=(r.parsed||0)+((f||"").parsed||r.chunks*t.chunk),r.more=1,r.next=g,o.map(h.list,(function(t,e){if(t&&l!==e)return r.next=e,1}),r.reverse?{reverse:1,end:l}:{start:l}),i&&(i.rl=+new Date),r.next||(r.more=0),r.next&&(!r.reverse&&(e<r.next&&0!=r.next.indexOf(e)||g!==r.end&&(r.end||"ï¿¿")<r.next)&&(r.more=0),r.reverse&&(e>r.next&&0!=e.indexOf(r.next)||g!==r.start&&(r.start||"")>r.next&&l<=r.start)&&(r.more=0)),r.more){if(p&&n(s.err,p,r),!(r.parsed>=r.limit)){var d=+new Date;i&&(i.rm=d);var y=r.next;u((function(){console.STAT&&console.STAT(d,+new Date-d,"rad more"),h.parse(y,s.check)}),0)}}else n(s.err,p,r)}else n(l===t.code.from?g:"No file!")}},check:function(e,n,r){if(s.get(e,n,r),n&&!n.check){n.check=1;var i=+new Date;(r||(r={})).file||(r.file=s.file),o.map(n,(function(e,n){h.find(n,(function(o){if((o||(o=t.code.from))!==r.file){var i=(""+Math.random()).slice(-3);c((function(){h.save(n,e,(function t(s,u){s?h.save(n,e,t):console.STAT&&console.STAT("MISLOCATED DATA CORRECTED",i,a(n),a(r.file),a(o))}))}),0)}}))})),console.STAT&&console.STAT(i,+new Date-i,"rad check")}}};h.find(e||(r.reverse?r.end||"":r.start||""),s.find)}}(),function(){var n=0,r={},i=String.fromCharCode(31);h.parse=function(s,u,f,d){var y;if(!s)return u();if(y=r[s])y.push(u);else{y=r[s]=[u];var v=function(){},w={file:s};(v.disk=o()).file=s,v.read=function(e,o){var i;if(d&&(d.rpg=+new Date),console.STAT&&console.STAT(m,+new Date-m,"read disk",JSON.stringify(s),++n,"total all parses."),(v.err=e)||(v.not=!o))return delete r[s],void v.map(y,v.ack);if("string"!==typeof o){try{t.max<=o.length?v.err="Chunk too big!":o=o.toString()}catch(a){v.err=a}if(v.err)return delete r[s],void v.map(y,v.ack)}w.parsed=o.length,d&&(d.rpl=w.parsed),d&&(d.rpa=y.length),m=+new Date,t.jsonify||"{"===o[0]?p(o,(function(t,e){return t?"{"===o[0]?(delete r[s],v.err=i||"JSON error!",void v.map(y,v.ack)):void v.radec(t,o):(delete r[s],v.disk.$=e,console.STAT&&(l=+new Date-m)>9&&console.STAT(m,l,"rad parsed JSON"),d&&(d.rpd=+new Date),void v.map(y,v.ack))})):v.radec(e,o)},v.map=function(){if(y&&y.length){var t,e=+new Date,n=v.err,r=v.not?g:v.disk,o=0;while(o<9&&(t=y[o++]))t(n,r,w);console.STAT&&console.STAT(e,+new Date-e,"rad packs",a(s)),console.STAT&&console.STAT(e,o,"rad packs #",a(s)),(y=y.slice(o)).length&&c(v.map,0)}},v.ack=function(t){t&&(v.err||v.not?t(v.err,g,w):t(g,v.disk,w))},v.radec=function(t,e){delete r[s],m=+new Date;var n,o,i,a=v.split(e),u=[];if(!a||0!==a[1])return v.err="File '"+s+"' does not have root radix! ",void v.map(y,v.ack);while(a)o=i=g,n=a[1],a=v.split(a[2])||"","#"==a[0]&&(o=a[1],u=u.slice(0,n),n<=u.length&&u.push(o)),a=v.split(a[2])||"","\n"!=a[0]&&("="!=a[0]&&":"!=a[0]||(i=a[1]),g!==o&&g!==i&&v.disk(u.join(""),i),a=v.split(a[2]));console.STAT&&console.STAT(m,+new Date-m,"parsed RAD"),v.map(y,v.ack)},v.split=function(t){if(t){var n=[],r={},o=-1,a="";if(o=t.indexOf(i),t[o])return a=t.slice(0,o),n[0]=a,n[1]=e.decode(t.slice(o),r),n[2]=t.slice(o+r.i),n}},h.disk&&(f||(f=(h.disk[s]||"").raw));var m=+new Date;if(d&&(d.rp=m),f)return c((function(){v.read(g,f)}),0);t.store.get(a(s),v.read)}}}(),function(){var e,n,r=String.fromCharCode(28);function i(n,s){if(n)return t.log("list",n),void setTimeout((function(){h.parse(r,i)}),1e3);s?a(s):(e=e||s||o(),t.store.list?t.store.list((function(t){t?h.find.add(t,y):a(e)})):a(e))}function a(t,o){e=e||t,e.file=r,o=n,n=null,f(o,(function(t){h.find(t[0],t[1])}))}h.find=function(a,s){if(!e)return n?void n.push([a,s]):(n=[[a,s]],void h.parse(r,i));o.map(h.list=e,(function(t,e){if(t)return s(e)||!0}),{reverse:1,end:a})||s(t.code.from)},h.find.add=function(t,n){var o=e(t);o||t===r?n(g,1):(e(t,1),n.found=(n.found||0)+1,h.write(r,e,(function(t,e){t?n(t):(n.found=(n.found||0)-1,0===n.found&&n(g,1))}),!0))},h.find.bad=function(t,n){e(t,0),h.write(r,e,n||y)}}();try{!r.window&&n(1430)(h)}catch(v){}var g,y=function(){};return e.has[t.file]=h,h}if(function(){var t=String.fromCharCode(31);e.encode=function(e,n,r){r=r||t;var o,i=r;if("string"==typeof e){var a=e.indexOf(r);while(-1!=a)i+=r,a=e.indexOf(r,a+1);return i+'"'+e+r}return e&&e["#"]&&1==Object.keys(e).length?i+"#"+o+i:"number"==typeof e?i+"+"+(e||0)+i:null===e?i+" "+i:!0===e?i+"+"+i:!1===e?i+"-"+i:void 0},e.decode=function(e,n,r){r=r||t;var o,i,a="",s=-1,u=0;if(r===e[0]){while(r===e[++s])++u;i=e[o=u]||!0;while(--u>=0)s=e.indexOf(r,s+1);return-1==s&&(s=e.length),a=e.slice(o+1,s),n&&(n.i=s+1),'"'===i?a:"#"===i?{"#":a}:"+"===i?0===a.length||parseFloat(a):" "===i?null:"-"!==i&&void 0}}}(),"undefined"!==typeof window){var r=window.Gun,o=window.Radix;window.Radisk=e}else{r=n(9220),o=n(531);try{t.exports=e}catch(i){}}e.Radix=o}()},531:function(t){(function(){function e(){var t=function(o,a,s){if(t.unit=0,s||n===a||(t.last=""+o<t.last?t.last:""+o,delete(t.$||{})[i]),s=s||t.$||(t.$={}),!o&&Object.keys(s).length)return s;o=""+o;var u,c,f=0,l=o.length-1,p=o[f];while(!(u=s[p])&&f<l)p+=o[++f];if(u){if(f!=l)return n!==a&&delete u[i],t(o.slice(++f),a,u||(u={}));if(n===a)return n===(c=u[""])?u:(t.unit=1)&&c;u[""]=a}else{if(!r(s,(function(t,r){var i=0,u="";if((r||"").length)while(r[i]==o[i])u+=r[i++];if(u){if(n===a){if(i<=l)return;return(c||(c={}))[r.slice(i)]=t,t}var f={};return f[r.slice(i)]=t,i=o.slice(i),""===i?f[""]=a:(f[i]={})[""]=a,s[u]=f,e.debug&&"undefined"===""+u&&console.log(0,u),delete s[r],!0}}))){if(n===a)return;(s[p]||(s[p]={}))[""]=a,e.debug&&"undefined"===""+p&&console.log(1,p)}if(n===a)return c}};return t}if(e.map=function t(r,a,s,u){u=u||[];var c="function"==typeof r?r.$||{}:r;//!opt && console.log("WHAT IS T?", JSON.stringify(t).length);
if(c)if("string"!=typeof c){var f,l=(c[i]||o).sort||(c[i]=function t(){return t.sort=Object.keys(c).sort(),t}()).sort;s=!0===s?{branch:!0}:s||{},(f=s.reverse)&&(l=l.slice(0).reverse());for(var p=s.start,h=s.end,d="ï¿¿",g=0,y=l.length;g<y;g++){var v,w,m,b=l[g],k=c[b];if(k&&""!==b&&i!==b&&"undefined"!==b&&(w=u.slice(0),w.push(b),m=w.join(""),!(n!==p&&m<(p||"").slice(0,m.length))&&!(n!==h&&(h||d)<m))){if(f&&(v=t(k,a,s,w),n!==v))return v;if(n!==(v=k[""])){var A=1;if(n!==p&&m<(p||"")&&(A=0),n!==h&&m>(h||d)&&(A=0),A&&(v=a(v,m,b,u),n!==v))return v}else if(s.branch&&(v=a(n,m,b,u),n!==v))return v;if(u=w,!f&&(v=t(k,a,s,u),n!==v))return v;u.pop()}}}else if(e.debug)throw["BUG:",r,a,s,u]},"undefined"!==typeof window)window.Radix=e;else try{t.exports=e}catch(a){}var n,r=e.object=function(t,e,r){for(var o in t)if(t.hasOwnProperty(o)&&(r=e(t[o],o))!==n)return r},o={},i=String.fromCharCode(24)})()},1430:function(t,e,n){t.exports=function(t){var e=n(531);t.find("a",(function(){var n,r,o=[];e.map(t.list,(function(t,e){e.indexOf("%1B")+1&&t&&o.push([e,t])})),o.length&&console.log("\n! ! ! WARNING ! ! !\nRAD v0.2020.x has detected OLD v0.2019.x data & automatically migrating. Automatic migration will be turned OFF in future versions! If you are just developing/testing, we recommend you reset your data. Please contact us if you have any concerns.\nThis message should only log once."),o.forEach((function(e){n=e[0],r=e[1],t.list(decodeURIComponent(n),r),t.list(n,0)})),n&&t.find.bad(n)}))}},2223:function(t,e,n){(function(){function e(t){t=t||{},t.file=String(t.file||"radata");var n,r=e[t.file],o=null;if(r)return console.log("Warning: reusing same IndexedDB store and options as 1st."),e[t.file];r=e[t.file]=function(){};try{t.indexedDB=t.indexedDB||e.indexedDB||indexedDB}catch(a){}try{if(!t.indexedDB||"file:"==location.protocol){var i=r.d||(r.d={});return r.put=function(t,e,n){i[t]=e,setTimeout((function(){n(null,1)}),250)},r.get=function(t,e){setTimeout((function(){e(null,i[t]||n)}),5)},console.log("Warning: No indexedDB exists to persist data to!"),r}}catch(a){}return r.start=function(){var e=indexedDB.open(t.file,1);e.onupgradeneeded=function(e){e.target.result.createObjectStore(t.file)},e.onsuccess=function(){o=e.result},e.onerror=function(t){console.log(t||1)}},r.start(),r.put=function(e,n,i){if(o){var a=o.transaction([t.file],"readwrite"),s=a.objectStore(t.file),u=s.put(n,""+e);u.onsuccess=s.onsuccess=a.onsuccess=function(){i(null,1)},u.onabort=s.onabort=a.onabort=function(t){i(t||"put.tx.abort")},u.onerror=s.onerror=a.onerror=function(t){i(t||"put.tx.error")}}else setTimeout((function(){r.put(e,n,i)}),1)},r.get=function(e,n){if(o){var i=o.transaction([t.file],"readonly"),a=i.objectStore(t.file),s=a.get(""+e);s.onsuccess=function(){n(null,s.result)},s.onabort=function(t){n(t||4)},s.onerror=function(t){n(t||5)}}else setTimeout((function(){r.get(e,n)}),9)},setInterval((function(){o&&o.close(),o=null,r.start()}),15e3),r}if("undefined"!==typeof window)(e.window=window).RindexedDB=e,e.indexedDB=window.indexedDB;else try{t.exports=e}catch(o){}try{var r=e.window.Gun||n(9220);r.on("create",(function(t){this.to.next(t),t.opt.store=t.opt.store||e(t.opt)}))}catch(o){}})()},3266:function(t,e,n){var r="undefined"!==typeof window?window.Gun:n(9220);r.on("create",(function(t){r.TESTING&&(t.opt.file="radatatest"),this.to.next(t);var e,o=t.opt;if(!1!==o.rad&&!1!==o.radisk&&(e+""==typeof process||"false"!==""+({NODE_ENV:"production",BASE_URL:"/graph-gun/"}||0).RAD)){var i=r.window&&r.window.Radisk||n(8822),a=i.Radix,s=i(o),u=String.fromCharCode(27),c=0;t.on("put",(function(e){if(this.to.next(e),!(e._||"").rad){var n=e["#"],r=e.put,o=r["#"],i=r["."],a=r[":"],c=r[">"],f=(e._||"").DBG;f&&(f.sp=f.sp||+new Date);var l=(e._||"").RPS||((e._||"").RPS=+new Date);s(o+u+i,{":":a,">":c},(function(e,r){f&&(f.spd=f.spd||+new Date),console.STAT&&console.STAT(l,+new Date-l,"put"),e?t.on("in",{"@":n,err:e,DBG:f}):t.on("in",{"@":n,ok:r,DBG:f})}),!1,f&&(f.r=f.r||{})),f&&(f.sps=f.sps||+new Date)}}));Object.empty;t.on("get",(function(n){this.to.next(n);var l=n._||"",p=l.DBG=n.DBG;p&&(p.sg=+new Date);var h,d,g,y,v=n["#"],w=n.get,m=n.get["#"],b=n.get["."]||"",k={};if("string"==typeof m?d=m:m&&(e!==(g=m["*"])&&(k.limit=y=1),e!==m[">"]&&(k.start=m[">"]),e!==m["<"]&&(k.end=m["<"]),d=y?""+g:g||m["="],y=null),d&&!k.limit&&("string"==typeof b?d=d+u+(k.atom=b):b&&(e!==b[">"]&&(k.start=b[">"],k.limit=1),e!==b["<"]&&(k.end=b["<"],k.limit=1),e!==(g=b["*"])&&(k.limit=y=1),d&&(d=d+u+(y?""+(g||""):g||(k.atom=b["="]||""))))),((g=w["%"])||k.limit)&&(k.limit=g<=(k.pack||1e5)?g:1),(b["-"]||(m||{})["-"]||w["-"])&&(k.reverse=!0),(g=(t.next||"")[m])&&g.put)if(k.atom){if(g=(g.next||"")[k.atom],g&&g.rad)return}else if(g&&g.rad)return;var A=r.state(),x=+new Date,S=0;function T(t,e,n,o){if(S++,t){e=(d+e).split(u);var a=e.slice(0,1)[0];if(e=e.slice(-1)[0],k.limit&&k.limit<=k.count)return!0;var s,c,f=a,l=e;if("string"!=typeof t)return s=t[":"],c=t[">"],(h=h||{})[f]=r.state.ify(h[f],l,c,s,f),void(k.count=(k.count||0)+((s||"").length||9));k.count=(k.count||0)+t.length;var p=t.lastIndexOf(">"),g=i.decode(t.slice(p+1),null,u);t=i.decode(t.slice(0,p),null,u),(h=h||{})[a]=r.state.ify(h[a],e,g,t,a)}}p&&(p.sgm=x),s(d||"",(function(n,i,s){p&&(p.sgr=+new Date),p&&(p.sgi=s);try{o.store.stats.get.time[f%50]=+new Date-x,++f,o.store.stats.get.count++,n&&(o.store.stats.get.err=n)}catch(E){}var l,g;if(console.STAT&&console.STAT(x,+new Date-x,"got",JSON.stringify(d)),x=+new Date,s=s||"",s.unit&&i&&e!==(l=i[":"])&&e!==(g=i[">"])){var y=d.split(u),_=y[0],D=y[1];(h=h||{})[_]=r.state.ify(h[_],D,g,l,_),t.$.get(_).get(D)._.rad=A}else i&&("string"!==typeof i&&(k.atom?i=e:a.map(i,T,k)),!h&&i&&T(i,""),!k.atom&&!b&"string"==typeof m&&!k.limit&&!k.more&&(t.$.get(m)._.rad=A));p&&(p.sgp=+new Date),console.STAT&&(c=+new Date-x)>9&&(console.STAT(x,c,"got prep time"),console.STAT(x,S,"got prep #")),c,S=0,x=+new Date;var O=function(){};O.faith=!0,O.rad=w,t.on("in",{"@":v,put:h,"%":s.more?1:e,err:n||e,_:O,DBG:p}),console.STAT&&(c=+new Date-x)>9&&console.STAT(x,c,"got emit",Object.keys(h||{}).length),h=e}),k,p&&(p.r=p.r||{})),p&&(p.sgd=+new Date),console.STAT&&(c=+new Date-x)>9&&console.STAT(x,c,"get call")}));r.valid;(o.store||{}).stats={get:{time:{},count:0},put:{time:{},count:0}};var f=0}}))},9056:function(t,e,n){n(4633),n(2262),n(4506),function(){var e,n={},r=setTimeout.turn||typeof setImmediate!=""+e&&setImmediate||setTimeout;function o(t){var e=parseFloat(t);return isNaN(e)?(t=t.trim(),"true"==t||"false"!=t&&("null"==t?null:void 0)):e}n.parseAsync=function(t,n,i,a){if("string"==typeof t){var s={i:0,text:t,done:n,l:t.length,up:[]};a=a||32768,u()}else try{n(e,JSON.parse(t))}catch(c){n(c)}function u(){var n,i,f=s.text,l=s.i,p=s.l,h=0,d=s.w;while(h++<a){var g=f[l++];if(l>p){s.end=!0;break}if(d){l=f.indexOf('"',l-1),g=f[l],i=0;while("\\"==f[l-++i]);i=!(i%2),n=n||i,'"'!=g||i||(d=e,i=s.s,s.a?(i=f.slice(s.sl,l),(n||1+i.indexOf("\\"))&&(i=JSON.parse('"'+i+'"')),s.at instanceof Array?s.at.push(s.s=i):(s.at||(s.end=h=a,i=e),(s.at||{})[s.s]=s.s=i),s.s=e):(s.s=f.slice(s.sl,l),(n||1+s.s.indexOf("\\"))&&(s.s=JSON.parse('"'+s.s+'"'))),s.a=n=e),++l}else switch(g){case'"':s.sl=l,d=!0;break;case":":s.ai=l,s.a=!0;break;case",":(s.a||s.at instanceof Array)&&(i=f.slice(s.ai,l-1))&&e!==(i=o(i))&&(s.at instanceof Array?s.at.push(i):s.at[s.s]=i),s.a=e,s.at instanceof Array&&(s.a=!0,s.ai=l);break;case"{":s.up.push(s.at||(s.at={})),s.at instanceof Array?s.at.push(s.at={}):e!==(i=s.s)&&(s.at[i]=s.at={}),s.a=e;break;case"}":s.a&&(i=f.slice(s.ai,l-1))&&e!==(i=o(i))&&(s.at instanceof Array?s.at.push(i):(s.at||(s.end=h=a,i=e),(s.at||{})[s.s]=i)),s.a=e,s.at=s.up.pop();break;case"[":e!==(i=s.s)?(s.up.push(s.at),s.at[i]=s.at=[]):s.at||s.up.push(s.at=[]),s.a=!0,s.ai=l;break;case"]":s.a&&(i=f.slice(s.ai,l-1))&&e!==(i=o(i))&&(s.at instanceof Array?s.at.push(i):s.at[s.s]=i),s.a=e,s.at=s.up.pop();break}}if(s.s=e,s.i=l,s.w=d,s.end){if(i=s.at,e===i)try{i=JSON.parse(t)}catch(c){return s.done(c)}s.done(e,i)}else r(u)}},n.stringifyAsync=function(t,n,o,i,a){a=a||{},a.text=a.text||"",a.up=[a.at={d:t}],a.done=n,a.i=0;var s=0;function u(){var t,n=a.at,o=n.d,i="";switch(n.i&&n.i-n.j>0&&(i+=","),e!==(t=n.k)&&(i+=JSON.stringify(t)+":"),typeof o){case"boolean":i+=""+o;break;case"string":i+=JSON.stringify(o);break;case"number":i+=o;break;case"object":if(!o){i+="null";break}if(o instanceof Array){i+="[",n={i:-1,as:o,up:n,j:0},n.l=o.length,a.up.push(a.at=n);break}if("function"!=typeof(o||"").toJSON){i+="{",n={i:-1,ok:Object.keys(o).sort(),as:o,up:n,j:0},n.l=n.ok.length,a.up.push(a.at=n);break}if(t=o.toJSON()){i+=t;break}case"function":if(n.as instanceof Array){i+="null";break}default:i="",n.j++}a.text+=i;while(1+n.i>=n.l)a.text+=n.ok?"}":"]",n=a.at=n.up;if(++n.i<n.l)return(t=n.ok)?n.d=n.as[n.k=t[n.i]]:n.d=n.as[n.i],++s<9?u():(s=0,void r(u));a.done(e,a.text)}u()},typeof window!=""+e&&(window.YSON=n);try{"object"!=""+e&&(t.exports=n)}catch(i){}typeof JSON!=""+e&&(JSON.parseAsync=n.parseAsync,JSON.stringifyAsync=n.stringifyAsync)}()},2032:function(t,e,n){t=n.nmd(t),n(2801),n(8675),n(3462),n(7380),n(1118),n(1703),function(){function e(t,r){return r?n(1661)(t):t.slice?e[o(t)]:function(n,r){t(n={exports:{}}),e[o(r)]=n.exports};function o(t){return t.split("/").slice(-1).toString().replace(".js","")}}var r=t;e((function(t){"undefined"!==typeof window&&(t.window=window);var e,n=t.window||t,o=n.SEA||{};(o.window=t.window)&&(o.window.SEA=o);try{e+""!==typeof r&&(r.exports=o)}catch(i){}t.exports=o}))(e,"./root"),e((function(t){var n=e("./root");try{n.window&&location.protocol.indexOf("s")<0&&location.host.indexOf("localhost")<0&&!/^127\.\d+\.\d+\.\d+$/.test(location.hostname)&&location.protocol.indexOf("file:")<0&&(console.warn("HTTPS needed for WebCrypto in SEA, redirecting..."),location.protocol="https:")}catch(r){}}))(e,"./https"),e((function(t){var r;if(r+""==typeof btoa){if(r+""==typeof Buffer)try{n.g.Buffer=e("buffer",1).Buffer}catch(o){console.log("Please `npm install buffer` or add it to your package.json !")}n.g.btoa=function(t){return Buffer.from(t,"binary").toString("base64")},n.g.atob=function(t){return Buffer.from(t,"base64").toString("binary")}}}))(e,"./base64"),e((function(t){function n(){}e("./base64"),Object.assign(n,{from:Array.from}),n.prototype=Object.create(Array.prototype),n.prototype.toString=function(t,e,n){t=t||"utf8",e=e||0;const r=this.length;if("hex"===t){const t=new Uint8Array(this);return[...Array((n&&n+1||r)-e).keys()].map((n=>t[n+e].toString(16).padStart(2,"0"))).join("")}return"utf8"===t?Array.from({length:(n||r)-e},((t,n)=>String.fromCharCode(this[n+e]))).join(""):"base64"===t?btoa(this):void 0},t.exports=n}))(e,"./array"),e((function(t){e("./base64");var n=e("./array");function r(...t){return console.warn("new SafeBuffer() is depreciated, please use SafeBuffer.from()"),r.from(...t)}r.prototype=Object.create(Array.prototype),Object.assign(r,{from(){if(!Object.keys(arguments).length||null==arguments[0])throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.");const t=arguments[0];let e;if("string"===typeof t){const r=arguments[1]||"utf8";if("hex"===r){const r=t.match(/([\da-fA-F]{2})/g).map((t=>parseInt(t,16)));if(!r||!r.length)throw new TypeError("Invalid first argument for type 'hex'.");e=n.from(r)}else if("utf8"===r||"binary"===r){const r=t.length,o=new Uint16Array(r);Array.from({length:r},((e,n)=>o[n]=t.charCodeAt(n))),e=n.from(o)}else if("base64"===r){const r=atob(t),o=r.length,i=new Uint8Array(o);Array.from({length:o},((t,e)=>i[e]=r.charCodeAt(e))),e=n.from(i)}else"binary"===r?e=n.from(t):console.info("SafeBuffer.from unknown encoding: "+r);return e}t.byteLength;const r=t.byteLength?t.byteLength:t.length;if(r){let e;return t instanceof ArrayBuffer&&(e=new Uint8Array(t)),n.from(e||t)}},alloc(t,e=0){return n.from(new Uint8Array(Array.from({length:t},(()=>e))))},allocUnsafe(t){return n.from(new Uint8Array(Array.from({length:t})))},concat(t){if(!Array.isArray(t))throw new TypeError("First argument must be Array containing ArrayBuffer or Uint8Array instances.");return n.from(t.reduce(((t,e)=>t.concat(Array.from(e))),[]))}}),r.prototype.from=r.from,r.prototype.toString=n.prototype.toString,t.exports=r}))(e,"./buffer"),e((function(t){const n=e("./root"),o={Buffer:e("./buffer")};var i,a={};if(JSON.parseAsync=JSON.parseAsync||function(t,e,n){var r;try{e(r,JSON.parse(t,n))}catch(o){e(o)}},JSON.stringifyAsync=JSON.stringifyAsync||function(t,e,n,r){var o;try{e(o,JSON.stringify(t,n,r))}catch(i){e(i)}},o.parse=function(t,e){return new Promise((function(n,r){JSON.parseAsync(t,(function(t,e){t?r(t):n(e)}),e)}))},o.stringify=function(t,e,n){return new Promise((function(r,o){JSON.stringifyAsync(t,(function(t,e){t?o(t):r(e)}),e,n)}))},n.window&&(o.crypto=window.crypto||window.msCrypto,o.subtle=(o.crypto||a).subtle||(o.crypto||a).webkitSubtle,o.TextEncoder=window.TextEncoder,o.TextDecoder=window.TextDecoder,o.random=t=>o.Buffer.from(o.crypto.getRandomValues(new Uint8Array(o.Buffer.alloc(t))))),!o.TextDecoder){const{TextEncoder:t,TextDecoder:n}=e((i+""==typeof r?".":"")+"./lib/text-encoding",1);o.TextDecoder=n,o.TextEncoder=t}if(!o.crypto)try{var s=e("crypto",1);Object.assign(o,{crypto:s,random:t=>o.Buffer.from(s.randomBytes(t))});const{Crypto:t}=e("@peculiar/webcrypto",1);o.ossl=o.subtle=new t({directory:"ossl"}).subtle}catch(u){console.log("Please `npm install @peculiar/webcrypto` or add it to your package.json !")}t.exports=o}))(e,"./shim"),e((function(t){var n=e("./root"),r=e("./shim"),o={pbkdf2:{hash:{name:"SHA-256"},iter:1e5,ks:64},ecdsa:{pair:{name:"ECDSA",namedCurve:"P-256"},sign:{name:"ECDSA",hash:{name:"SHA-256"}}},ecdh:{name:"ECDH",namedCurve:"P-256"},jwk:function(t,e){t=t.split(".");var n=t[0],r=t[1],o={kty:"EC",crv:"P-256",x:n,y:r,ext:!0};return o.key_ops=e?["sign"]:["verify"],e&&(o.d=e),o},keyToJwk:function(t){const e=t.toString("base64"),n=e.replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,"");return{kty:"oct",k:n,ext:!1,alg:"A256GCM"}},recall:{validity:43200,hook:function(t){return t}},check:function(t){return"string"==typeof t&&"SEA{"===t.slice(0,4)},parse:async function(t){try{var e="string"==typeof t;return e&&"SEA{"===t.slice(0,4)&&(t=t.slice(3)),e?await r.parse(t):t}catch(n){}return t}};n.opt=o,t.exports=o}))(e,"./settings"),e((function(t){var n=e("./shim");t.exports=async function(t,e){var r="string"==typeof t?t:await n.stringify(t),o=await n.subtle.digest({name:e||"SHA-256"},(new n.TextEncoder).encode(r));return n.Buffer.from(o)}}))(e,"./sha256"),e((function(t){const n=e("./shim"),r=n.subtle,o=n.ossl?n.ossl:r,i=t=>o.digest({name:"SHA-1"},new ArrayBuffer(t));t.exports=i}))(e,"./sha1"),e((function(t){var n,r=e("./root"),o=e("./shim"),i=e("./settings"),a=e("./sha256");r.work=r.work||(async(t,e,s,u)=>{try{var c=(e||{}).epub||e;if(u=u||{},c instanceof Function&&(s=c,c=n),t="string"==typeof t?t:await o.stringify(t),"sha"===(u.name||"").toLowerCase().slice(0,3)){var f=o.Buffer.from(await a(t,u.name),"binary").toString(u.encode||"base64");if(s)try{s(f)}catch(d){console.log(d)}return f}c=c||o.random(9);var l=await(o.ossl||o.subtle).importKey("raw",(new o.TextEncoder).encode(t),{name:u.name||"PBKDF2"},!1,["deriveBits"]),p=await(o.ossl||o.subtle).deriveBits({name:u.name||"PBKDF2",iterations:u.iterations||i.pbkdf2.iter,salt:(new o.TextEncoder).encode(u.salt||c),hash:u.hash||i.pbkdf2.hash},l,u.length||8*i.pbkdf2.ks);t=o.random(t.length);var h=o.Buffer.from(p,"binary").toString(u.encode||"base64");if(s)try{s(h)}catch(d){console.log(d)}return h}catch(d){if(console.log(d),r.err=d,r.throw)throw d;return void(s&&s())}}),t.exports=r.work}))(e,"./work"),e((function(t){var n=e("./root"),r=e("./shim");e("./settings");n.name=n.name||(async(t,e)=>{try{if(t)try{t()}catch(r){console.log(r)}return}catch(r){if(console.log(r),n.err=r,n.throw)throw r;return void(t&&t())}}),n.pair=n.pair||(async(t,e)=>{try{var o=r.ossl||r.subtle,i=await r.subtle.generateKey({name:"ECDSA",namedCurve:"P-256"},!0,["sign","verify"]).then((async t=>{var e={};e.priv=(await r.subtle.exportKey("jwk",t.privateKey)).d;var n=await r.subtle.exportKey("jwk",t.publicKey);return e.pub=n.x+"."+n.y,e}));try{var a=await o.generateKey({name:"ECDH",namedCurve:"P-256"},!0,["deriveKey"]).then((async t=>{var e={};e.epriv=(await o.exportKey("jwk",t.privateKey)).d;var n=await o.exportKey("jwk",t.publicKey);return e.epub=n.x+"."+n.y,e}))}catch(u){if(n.window)throw u;if("Error: ECDH is not a supported algorithm"!=u)throw u;console.log("Ignoring ECDH...")}a=a||{};var s={pub:i.pub,priv:i.priv,epub:a.epub,epriv:a.epriv};if(t)try{t(s)}catch(u){console.log(u)}return s}catch(u){if(console.log(u),n.err=u,n.throw)throw u;return void(t&&t())}}),t.exports=n.pair}))(e,"./pair"),e((function(t){var n,r=e("./root"),o=e("./shim"),i=e("./settings"),a=e("./sha256");r.sign=r.sign||(async(t,e,s,u)=>{try{if(u=u||{},!(e||u).priv){if(!r.I)throw"No signing key.";e=await r.I(null,{what:t,how:"sign",why:u.why})}if(n===t)throw"`undefined` not allowed.";var c=await i.parse(t),f=u.check=u.check||c;if(r.verify&&(r.opt.check(f)||f&&f.s&&f.m)&&n!==await r.verify(f,e)){var l=await i.parse(f);if(u.raw||(l="SEA"+await o.stringify(l)),s)try{s(l)}catch(v){console.log(v)}return l}var p=e.pub,h=e.priv,d=i.jwk(p,h),g=await a(c),y=await(o.ossl||o.subtle).importKey("jwk",d,{name:"ECDSA",namedCurve:"P-256"},!1,["sign"]).then((t=>(o.ossl||o.subtle).sign({name:"ECDSA",hash:{name:"SHA-256"}},t,new Uint8Array(g))));l={m:c,s:o.Buffer.from(y,"binary").toString(u.encode||"base64")};if(u.raw||(l="SEA"+await o.stringify(l)),s)try{s(l)}catch(v){console.log(v)}return l}catch(v){if(console.log(v),r.err=v,r.throw)throw v;return void(s&&s())}}),t.exports=r.sign}))(e,"./sign"),e((function(t){var n,r=e("./root"),o=e("./shim"),i=e("./settings"),a=e("./sha256");r.verify=r.verify||(async(t,e,s,u)=>{try{var c=await i.parse(t);if(!1===e){var f=await i.parse(c.m);if(s)try{s(f)}catch(w){console.log(w)}return f}u=u||{};var l,p,h,d=e.pub||e,g=r.opt.slow_leak?await r.opt.slow_leak(d):await(o.ossl||o.subtle).importKey("jwk",i.jwk(d),{name:"ECDSA",namedCurve:"P-256"},!1,["verify"]),y=await a(c.m);try{if(l=o.Buffer.from(c.s,u.encode||"base64"),p=new Uint8Array(l),h=await(o.ossl||o.subtle).verify({name:"ECDSA",hash:{name:"SHA-256"}},g,p,new Uint8Array(y)),!h)throw"Signature did not match."}catch(w){if(r.opt.fallback)return await r.opt.fall_verify(t,e,s,u)}var v=h?await i.parse(c.m):n;if(s)try{s(v)}catch(w){console.log(w)}return v}catch(w){if(console.log(w),r.err=w,r.throw)throw w;return void(s&&s())}}),t.exports=r.verify;var s={},u=(r.opt.slow_leak=t=>{if(s[t])return s[t];var e=i.jwk(t);return s[t]=(o.ossl||o.subtle).importKey("jwk",e,{name:"ECDSA",namedCurve:"P-256"},!1,["verify"]),s[t]},r.opt);r.opt.fall_verify=async function(t,e,s,c,f){if(f===r.opt.fallback)throw"Signature did not match";f=f||1;var l=t||"";t=r.opt.unpack(t)||t;var p,h,d,g=await i.parse(t),y=e.pub||e,v=await r.opt.slow_leak(y),w=f<=r.opt.fallback?o.Buffer.from(await o.subtle.digest({name:"SHA-256"},(new o.TextEncoder).encode(await i.parse(g.m)))):await a(g.m);try{if(p=o.Buffer.from(g.s,c.encode||"base64"),h=new Uint8Array(p),d=await(o.ossl||o.subtle).verify({name:"ECDSA",hash:{name:"SHA-256"}},v,h,new Uint8Array(w)),!d)throw"Signature did not match."}catch(b){try{p=o.Buffer.from(g.s,"utf8"),h=new Uint8Array(p),d=await(o.ossl||o.subtle).verify({name:"ECDSA",hash:{name:"SHA-256"}},v,h,new Uint8Array(w))}catch(b){if(!d)throw"Signature did not match."}}var m=d?await i.parse(g.m):n;if(u.fall_soul=l["#"],u.fall_key=l["."],u.fall_val=t,u.fall_state=l[">"],s)try{s(m)}catch(b){console.log(b)}return m},r.opt.fallback=2}))(e,"./verify"),e((function(t){var n=e("./shim"),r=e("./settings"),o=e("./sha256");const i=async(t,e,i)=>{i=i||{};const a=t+(e||n.random(8)).toString("utf8"),s=n.Buffer.from(await o(a),"binary"),u=r.keyToJwk(s);return await n.subtle.importKey("jwk",u,{name:"AES-GCM"},!1,["encrypt","decrypt"])};t.exports=i}))(e,"./aeskey"),e((function(t){var n,r=e("./root"),o=e("./shim"),i=(e("./settings"),e("./aeskey"));r.encrypt=r.encrypt||(async(t,e,a,s)=>{try{s=s||{};var u=(e||s).epriv||e;if(n===t)throw"`undefined` not allowed.";if(!u){if(!r.I)throw"No encryption key.";e=await r.I(null,{what:t,how:"encrypt",why:s.why}),u=e.epriv||e}var c="string"==typeof t?t:await o.stringify(t),f={s:o.random(9),iv:o.random(15)},l=await i(u,f.s,s).then((t=>o.subtle.encrypt({name:s.name||"AES-GCM",iv:new Uint8Array(f.iv)},t,(new o.TextEncoder).encode(c)))),p={ct:o.Buffer.from(l,"binary").toString(s.encode||"base64"),iv:f.iv.toString(s.encode||"base64"),s:f.s.toString(s.encode||"base64")};if(s.raw||(p="SEA"+await o.stringify(p)),a)try{a(p)}catch(h){console.log(h)}return p}catch(h){if(console.log(h),r.err=h,r.throw)throw h;return void(a&&a())}}),t.exports=r.encrypt}))(e,"./encrypt"),e((function(t){var n=e("./root"),r=e("./shim"),o=e("./settings"),i=e("./aeskey");n.decrypt=n.decrypt||(async(t,e,a,s)=>{try{s=s||{};var u=(e||s).epriv||e;if(!u){if(!n.I)throw"No decryption key.";e=await n.I(null,{what:t,how:"decrypt",why:s.why}),u=e.epriv||e}var c,f,l,p=await o.parse(t);try{c=r.Buffer.from(p.s,s.encode||"base64"),f=r.Buffer.from(p.iv,s.encode||"base64"),l=r.Buffer.from(p.ct,s.encode||"base64");var h=await i(u,c,s).then((t=>r.subtle.decrypt({name:s.name||"AES-GCM",iv:new Uint8Array(f),tagLength:128},t,new Uint8Array(l))))}catch(g){if("utf8"===s.encode)throw"Could not decrypt";if(n.opt.fallback)return s.encode="utf8",await n.decrypt(t,e,a,s)}var d=await o.parse(new r.TextDecoder("utf8").decode(h));if(a)try{a(d)}catch(g){console.log(g)}return d}catch(g){if(console.log(g),n.err=g,n.throw)throw g;return void(a&&a())}}),t.exports=n.decrypt}))(e,"./decrypt"),e((function(t){var n=e("./root"),r=e("./shim");e("./settings");n.secret=n.secret||(async(t,e,i,a)=>{try{if(a=a||{},!e||!e.epriv||!e.epub){if(!n.I)throw"No secret mix.";e=await n.I(null,{what:t,how:"secret",why:a.why})}var s=t.epub||t,u=e.epub,c=e.epriv,f=r.ossl||r.subtle,l=o(s),p=Object.assign({public:await f.importKey(...l,!0,[])},{name:"ECDH",namedCurve:"P-256"}),h=o(u,c),d=await f.importKey(...h,!1,["deriveBits"]).then((async t=>{var e=await f.deriveBits(p,t,256),n=new Uint8Array(e),r=await f.importKey("raw",n,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"]);return f.exportKey("jwk",r).then((({k:t})=>t))})),g=d;if(i)try{i(g)}catch(y){console.log(y)}return g}catch(y){if(console.log(y),n.err=y,n.throw)throw y;return void(i&&i())}});var o=(t,e)=>{var[n,r]=t.split("."),o=e?{d:e}:{};return["jwk",Object.assign(o,{x:n,y:r,kty:"EC",crv:"P-256",ext:!0}),{name:"ECDH",namedCurve:"P-256"}]};t.exports=n.secret}))(e,"./secret"),e((function(t){var n=e("./root");n.certify=n.certify||(async(t,e={},r,o,i={})=>{try{if(console.log("SEA.certify() is an early experimental community supported method that may change API behavior without warning in any future version."),t=(()=>{var e=[];if(t){if(("string"===typeof t||Array.isArray(t))&&t.indexOf("*")>-1)return"*";if("string"===typeof t)return t;if(Array.isArray(t)){if(1===t.length&&t[0])return"object"===typeof t[0]&&t[0].pub?t[0].pub:"string"===typeof t[0]?t[0]:null;t.map((t=>{"string"===typeof t?e.push(t):"object"===typeof t&&t.pub&&e.push(t.pub)}))}return"object"===typeof t&&t.pub?t.pub:e.length>0?e:null}})(),!t)return console.log("No certificant found.");const u=!i.expiry||"number"!==typeof i.expiry&&"string"!==typeof i.expiry?null:parseFloat(i.expiry),c=(e||{}).read?e.read:null,f=(e||{}).write?e.write:"string"===typeof e||Array.isArray(e)||e["+"]||e["#"]||e["."]||e["="]||e["*"]||e[">"]||e["<"]?e:null,l=(i||{}).block||(i||{}).blacklist||(i||{}).ban||{},p=l.read&&("string"===typeof l.read||(l.read||{})["#"])?l.read:null,h="string"===typeof l?l:l.write&&("string"===typeof l.write||l.write["#"])?l.write:null;if(!c&&!f)return console.log("No policy found.");const d=JSON.stringify({c:t,...u?{e:u}:{},...c?{r:c}:{},...f?{w:f}:{},...p?{rb:p}:{},...h?{wb:h}:{}}),g=await n.sign(d,r,null,{raw:1});var a=g;if(i.raw||(a="SEA"+JSON.stringify(a)),o)try{o(a)}catch(s){console.log(s)}return a}catch(s){if(n.err=s,n.throw)throw s;return void(o&&o())}}),t.exports=n.certify}))(e,"./certify"),e((function(t){var n=e("./shim"),r=e("./root");r.work=e("./work"),r.sign=e("./sign"),r.verify=e("./verify"),r.encrypt=e("./encrypt"),r.decrypt=e("./decrypt"),r.certify=e("./certify"),r.random=r.random||n.random,r.Buffer=r.Buffer||e("./buffer"),r.keyid=r.keyid||(async t=>{try{const e=n.Buffer.concat(t.replace(/-/g,"+").replace(/_/g,"/").split(".").map((t=>n.Buffer.from(t,"base64")))),r=n.Buffer.concat([n.Buffer.from([153,e.length/256,e.length%256]),e]),o=await sha1hash(r),i=n.Buffer.from(o,"binary");return i.toString("hex",i.length-8)}catch(e){throw console.log(e),e}}),((r.window||{}).GUN||{}).SEA=r,t.exports=r}))(e,"./sea"),e((function(t){var n,o,i=e("./sea");function a(t){this._={$:this}}function s(){return n.state().toString(36).replace(".","")}n=i.window?i.window.GUN||{chain:{}}:e((o+""==typeof r?".":"")+"./gun",1),i.GUN=n,a.prototype=function(){function t(){}return t.prototype=n.chain,new t}(),a.prototype.constructor=a,n.chain.user=function(t){var e,n=this,r=n.back(-1);if(t)return t=i.opt.pub((t._||"")["#"])||t,r.get("~"+t);if(e=r.back("user"))return e;r=r._;var o=r,u=o.opt.uuid||s;return(o=(e=o.user=n.chain(new a))._).opt={},o.opt.uuid=function(t){var e=u(),n=r.user;return n&&(n=n.is)&&(n=n.pub)?(e="~"+n+"/"+e,t&&t.call&&t(null,e),e):e},e},n.User=a,a.GUN=n,a.SEA=n.SEA=i,t.exports=a}))(e,"./user"),e((function(t){var n,o=""+n!=typeof window?window.Gun||{chain:{}}:e((""+n===typeof r?".":"")+"./gun",1);o.chain.then=function(t,e){var n=this,r=new Promise((function(t,r){n.once(t,e)}));return t?r.then(t):r}}))(e,"./then"),e((function(t){var n=e("./user"),r=n.SEA,o=n.GUN,i=function(){};n.prototype.create=function(...t){var e,n="object"===typeof t[0]&&(t[0].pub||t[0].epub)?t[0]:"object"===typeof t[1]&&(t[1].pub||t[1].epub)?t[1]:null,a=n&&(n.pub||n.epub)?n.pub:"string"===typeof t[0]?t[0]:null,s=n&&(n.pub||n.epub)?n:a&&"string"===typeof t[1]?t[1]:null,u=t.filter((t=>"function"===typeof t))[0]||null,c=t&&t.length>1&&"object"===typeof t[t.length-1]?t[t.length-1]:{},f=this,l=f._,p=f.back(-1);if((u=u||i,c=c||{},!1!==c.check)&&(a||(e="No user."),(s||"").length<8&&(e="Password too short!"),e))return u({err:o.log(e)}),f;if(l.ing)return(u||i)({err:o.log("User is already being created or authenticated!"),wait:!0}),f;l.ing=!0;var h={};return h.a=function(t){if(h.pubs=t,t&&!c.already){var e={err:o.log("User already created!")};return l.ing=!1,(u||i)(e),void f.leave()}h.salt=String.random(64),r.work(s,h.salt,h.b)},h.b=function(t){h.proof=t,n?h.c(n):r.pair(h.c)},h.c=function(t){var e;h.pair=t||{},(e=l.root.user)&&(e._.sea=t,e.is={pub:t.pub,epub:t.epub,alias:a}),h.data={pub:t.pub},h.d()},h.d=function(){h.data.alias=a,h.e()},h.e=function(){h.data.epub=h.pair.epub,r.encrypt({priv:h.pair.priv,epriv:h.pair.epriv},h.proof,h.f,{raw:1})},h.f=function(t){h.data.auth=JSON.stringify({ek:t,s:h.salt}),h.g(h.data.auth)},h.g=function(t){var e;h.data.auth=h.data.auth||t,p.get(e="~"+h.pair.pub).put(h.data).on(h.h);var n={};n[e]={"#":e},p.get("~@"+a).put(n).get(e).on(h.i)},h.h=function(t,e,n,r){r.off(),h.h.ok=1,h.i()},h.i=function(t,e,r,o){o&&(h.i.ok=1,o.off()),h.h.ok&&h.i.ok&&(l.ing=!1,u({ok:0,pub:h.pair.pub}),i===u&&(n?f.auth(n):f.auth(a,s)))},p.get("~@"+a).once(h.a),f},n.prototype.leave=function(t,e){var n=this,o=n.back(-1)._.user;if(o&&(delete o.is,delete o._.is,delete o._.sea),r.window)try{var i={};i=window.sessionStorage,delete i.recall,delete i.pair}catch(a){}return n}}))(e,"./create"),e((function(t){var n=e("./user"),r=n.SEA,o=n.GUN,i=function(){};function a(t){if("string"!=typeof t)return t;try{t=JSON.parse(t)}catch(e){t={}}return t}n.prototype.auth=function(...t){var e="object"===typeof t[0]&&(t[0].pub||t[0].epub)?t[0]:"object"===typeof t[1]&&(t[1].pub||t[1].epub)?t[1]:null,n=e||"string"!==typeof t[0]?null:t[0],s=n&&"string"===typeof t[1]?t[1]:null,u=t.filter((t=>"function"===typeof t))[0]||null,c=t&&t.length>1&&"object"===typeof t[t.length-1]?t[t.length-1]:{},f=this,l=f._,p=f.back(-1);if(l.ing)return(u||i)({err:o.log("User is already being created or authenticated!"),wait:!0}),f;l.ing=!0;var h,d={};return d.a=function(t){if(!t)return d.b();if(!t.pub){var e=[];return Object.keys(t).forEach((function(n){"_"!=n&&e.push(t[n])})),d.b(e)}if(d.name)return d.f(t);d.c((d.data=t).auth)},d.b=function(t){var e=(d.list=(d.list||[]).concat(t||[])).shift();if(h===e)return d.name?d.err("Your user account is not published for dApps to access, please consider syncing it online, or allowing local access by adding your device as a peer."):d.err("Wrong user or password.");p.get(e).once(d.a)},d.c=function(t){return h===t?d.b():"string"==typeof t?d.c(a(t)):void r.work(s,(d.auth=t).s,d.d,d.enc)},d.d=function(t){r.decrypt(d.auth.ek,t,d.e,d.enc)},d.e=function(t){if(h===t)return d.enc?(d.enc=null,d.b()):(d.enc={encode:"utf8"},d.c(d.auth));d.half=t,d.f(d.data)},d.f=function(t){var e=d.half||{},n=d.data||{};d.g(d.lol={pub:t.pub||n.pub,epub:t.epub||n.epub,priv:t.priv||e.priv,epriv:t.epriv||e.epriv})},d.g=function(t){if(!t||!t.pub||!t.epub)return d.b();d.pair=t;var e=p._.user,g=e._,y=(g.tag,g.opt);g=e._=p.get("~"+t.pub)._,g.opt=y,e.is={pub:t.pub,epub:t.epub,alias:n||t.pub},g.sea=d.pair,l.ing=!1;try{s&&h==(a(l.root.graph["~"+t.pub].auth)||"")[":"]&&(c.shuffle=c.change=s)}catch(w){}if(c.change?d.z():(u||i)(g),r.window&&(f.back("user")._.opt||c).remember)try{var v={};v=window.sessionStorage,v.recall=!0,v.pair=JSON.stringify(t)}catch(w){}try{p._.tag.auth?p._.on("auth",g):setTimeout((function(){p._.on("auth",g)}),1)}catch(w){o.log("Your 'auth' callback crashed with:",w)}},d.z=function(){d.salt=String.random(64),r.work(c.change,d.salt,d.y)},d.y=function(t){r.encrypt({priv:d.pair.priv,epriv:d.pair.epriv},t,d.x,{raw:1})},d.x=function(t){d.w(JSON.stringify({ek:t,s:d.salt}))},d.w=function(t){if(c.shuffle){console.log("migrate core account from UTF8 & shuffle");var e={};Object.keys(d.data).forEach((function(t){e[t]=d.data[t]})),delete e._,e.auth=t,p.get("~"+d.pair.pub).put(e)}p.get("~"+d.pair.pub).get("auth").put(t,u||i)},d.err=function(t){var e={err:o.log(t||"User cannot be found!")};l.ing=!1,(u||i)(e)},d.plugin=function(t){if(!(d.name=t))return d.err();var e=[t];"~"!==t[0]&&(e[1]="~"+t,e[2]="~@"+t),d.b(e)},e?d.g(e):n?p.get("~@"+n).once(d.a):n||s||r.name(d.plugin),f}}))(e,"./auth"),e((function(t){var n=e("./user"),r=n.SEA;n.GUN;n.prototype.recall=function(t,e){var n=this,o=n.back(-1);if(t=t||{},t&&t.sessionStorage){if(r.window)try{var i={};i=window.sessionStorage,i&&(o._.opt.remember=!0,(n.back("user")._.opt||t).remember=!0,(i.recall||i.pair)&&o.user().auth(JSON.parse(i.pair),e))}catch(a){}return n}return n}}))(e,"./recall"),e((function(t){var n=e("./user"),r=n.SEA,o=n.GUN,i=function(){};n.prototype.pair=function(){var t,e=this;try{t=new Proxy({DANGER:"â "},{get:function(t,n,r){if(e.is&&(e._||"").sea)return e._.sea[n]}})}catch(n){}return t},n.prototype.delete=async function(t,e,n){console.log("user.delete() IS DEPRECATED AND WILL BE MOVED TO A MODULE!!!");var r=this,a=(r.back(-1),r.back("user"));try{a.auth(t,e,(function(t){(a.is||{}).pub;a.map().once((function(){this.put(null)})),a.leave(),(n||i)({ok:0})}))}catch(s){o.log("User.delete failed! Error:",s)}return r},n.prototype.alive=async function(){console.log("user.alive() IS DEPRECATED!!!");const t=this.back(-1);try{return await authRecall(t),t._.user._}catch(e){const t="No session!";throw o.log(t),{err:t}}},n.prototype.trust=async function(t){console.log("`.trust` API MAY BE DELETED OR CHANGED OR RENAMED, DO NOT USE!"),o.is(t)&&t.get("pub").get(((t,e)=>{console.log(t,e)})),t.get("trust").get(path).put(theirPubkey)},n.prototype.grant=function(t,e){console.log("`.grant` API MAY BE DELETED OR CHANGED OR RENAMED, DO NOT USE!");var n=this,o=n.back(-1).user(),i=o._.sea,a="";return n.back((function(t){t.is||(a+=t.get||"")})),async function(){var n,s=await o.get("grant").get(i.pub).get(a).then();s=await r.decrypt(s,i),s||(s=r.random(16).toString(),n=await r.encrypt(s,i),o.get("grant").get(i.pub).get(a).put(n));var u=t.get("pub").then(),c=t.get("epub").then();u=await u,c=await c;var f=await r.secret(c,i);n=await r.encrypt(s,f),o.get("grant").get(u).get(a).put(n,e)}(),n},n.prototype.secret=function(t,e){console.log("`.secret` API MAY BE DELETED OR CHANGED OR RENAMED, DO NOT USE!");var n=this,o=n.back(-1).user(),i=o.pair(),a="";return n.back((function(t){t.is||(a+=t.get||"")})),async function(){var s,u=await o.get("trust").get(i.pub).get(a).then();u=await r.decrypt(u,i),u||(u=r.random(16).toString(),s=await r.encrypt(u,i),o.get("trust").get(i.pub).get(a).put(s)),s=await r.encrypt(t,u),n.put(s,e)}(),n},t.exports=n}))(e,"./share"),e((function(t){var n,o=e("./sea"),i=e("./settings"),a=function(){},s=""+n!=typeof window?window.Gun||{on:a}:e((""+n===typeof r?".":"")+"./gun",1);function u(t){var e,n=this,r=n.as,i=t.put,a=i["#"],c=i["."],f=i[":"],l=i[">"],p=t["#"];if(a&&c)if((t._||"").faith&&(r.opt||"").faith&&"function"==typeof t._)o.opt.pack(i,(function(e){o.verify(e,!1,(function(e){i["="]=o.opt.unpack(e),n.to.next(t)}))}));else{var h=function(e){r.on("in",{"@":p,err:t.err=e})};(t._||"").DBG&&((t._||"").DBG.c=+new Date),0<=a.indexOf("<?")&&(e=parseFloat(a.split("<?")[1]||""),e&&l<s.state()-1e3*e)?(e=t._)&&e.stun&&e.stun--:"~@"!==a?"~@"!==a.slice(0,2)?(e=o.opt.pub(a))?u.pub(n,t,f,c,a,r,h,r.user||"",e):0<=a.indexOf("#")?u.hash(n,t,f,c,a,r,h):u.any(n,t,f,c,a,r,h,r.user||""):u.pubs(n,t,f,c,a,r,h):u.alias(n,t,f,c,a,r,h)}}s.on("opt",(function(t){t.sea||(t.sea={own:{}},t.on("put",u,t)),this.to.next(t)})),u.hash=function(t,e,n,r,i,a,s){o.work(n,null,(function(n){if(n&&n===r.split("#").slice(-1)[0])return t.to.next(e);s("Data hash not same as hash!")}),{name:"SHA-256"})},u.alias=function(t,e,n,r,o,i,a){return n?"~@"+r===f(n)?t.to.next(e):void a("Alias not same!"):a("Data must exist!")},u.pubs=function(t,e,n,r,o,i,a){return n?r===f(n)?t.to.next(e):void a("Alias not same!"):a("Alias must exist!")},u.pub=async function(t,e,r,a,u,c,l,p,h){var d;const g=await i.parse(r)||{},y=(r,i,c)=>{if(r.m&&r.s&&i&&h)return o.verify(r,h,(r=>{if(n!==r&&n!==r.e&&e.put[">"]&&e.put[">"]>parseFloat(r.e))return l("Certificate expired.");if(n!==r&&r.c&&r.w&&(r.c===i||r.c.indexOf("*")>-1)){let e=u.indexOf("/")>-1?u.replace(u.substring(0,u.indexOf("/")+1),""):"";String.match=String.match||s.text.match;const n=Array.isArray(r.w)?r.w:"object"===typeof r.w||"string"===typeof r.w?[r.w]:[];for(const s of n)if(String.match(e,s["#"])&&String.match(a,s["."])||!s["."]&&String.match(e,s["#"])||!s["#"]&&String.match(a,s["."])||String.match(e?e+"/"+a:a,s["#"]||s)){if(s["+"]&&s["+"].indexOf("*")>-1&&e&&-1==e.indexOf(i)&&-1==a.indexOf(i))return l(`Path "${e}" or key "${a}" must contain string "${i}".`);if(r.wb&&("string"===typeof r.wb||(r.wb||{})["#"])){var o=t.as.root.$.back(-1);return"string"===typeof r.wb&&"~"!==r.wb.slice(0,1)&&(o=o.get("~"+h)),o.get(r.wb).get(i).once((t=>!t||1!==t&&!0!==t?c(r):l(`Certificant ${i} blocked.`)))}return c(r)}return l("Certificate verification fail.")}}))};if("pub"===a&&"~"+h===u)return r===h?t.to.next(e):l("Account not same!");(d=p.is)&&d.pub&&!g["*"]&&!g["+"]&&(h===d.pub||h!==d.pub&&((e._.msg||{}).opt||{}).cert)?o.opt.pack(e.put,(a=>{o.sign(a,p._.sea,(async function(a){if(n===a)return l(o.err||"Signature fail.");if(e.put[":"]={":":d=o.opt.unpack(a.m),"~":a.s},e.put["="]=d,h===p.is.pub)return(d=f(r))&&((c.sea.own[d]=c.sea.own[d]||{})[h]=1),void JSON.stringifyAsync(e.put[":"],(function(n,r){return n?l(n||"Stringify error."):(e.put[":"]=r,t.to.next(e))}));if(h!==p.is.pub&&((e._.msg||{}).opt||{}).cert){const n=await i.parse(e._.msg.opt.cert);n&&n.m&&n.s&&y(n,p.is.pub,(r=>{e.put[":"]["+"]=n,e.put[":"]["*"]=p.is.pub,JSON.stringifyAsync(e.put[":"],(function(n,r){return n?l(n||"Stringify error."):(e.put[":"]=r,t.to.next(e))}))}))}}),{raw:1})})):o.opt.pack(e.put,(r=>{o.verify(r,g["*"]||h,(function(r){var i;return r=o.opt.unpack(r),n===r?l("Unverified data."):((i=f(r))&&h===o.opt.pub(i)&&((c.sea.own[i]=c.sea.own[i]||{})[h]=1),g["+"]&&g["+"]["m"]&&g["+"]["s"]&&g["*"]?void y(g["+"],g["*"],(n=>(e.put["="]=r,t.to.next(e)))):(e.put["="]=r,t.to.next(e)))}))}))},u.any=function(t,e,n,r,o,i,a,s){if(i.opt.secure)return a("Soul missing public key at '"+r+"'.");i.on("secure",(function(e){if(this.off(),!i.opt.secure)return t.to.next(e);a("Data cannot be changed.")})).on.on("secure",e)};var c=s.valid,f=function(t,e){return"string"==typeof(e=c(t))&&e},l=((s.state||"").ify,/[^\w_-]/);o.opt.pub=function(t){if(t&&(t=t.split("~"),t&&(t=t[1])&&(t=t.split(l).slice(0,2),t&&2==t.length&&"@"!==(t[0]||"")[0])))return t=t.slice(0,2).join("."),t},o.opt.stringy=function(t){},o.opt.pack=function(t,e,r,i,a){var u,c;if(o.opt.check(t))return e(t);t&&t["#"]&&t["."]&&t[">"]&&(u=t[":"],c=1),JSON.parseAsync(c?u:t,(function(o,u){var c=n!==(u||"")[":"]&&(u||"")["~"];e(c?{m:{"#":a||t["#"],".":r||t["."],":":(u||"")[":"],">":t[">"]||s.state.is(i,r)},s:c}:t)}))};var p=o.opt;o.opt.unpack=function(t,e,r){var i;if(n!==t){if(t&&n!==(i=t[":"]))return i;if(e=e||p.fall_key,!r&&p.fall_val&&(r={},r[e]=p.fall_val),e&&r){if(t===r[e])return t;if(!o.opt.check(r[e]))return t;var a=r&&r._&&r._["#"]||p.fall_soul,u=s.state.is(r,e)||p.fall_state;return t&&4===t.length&&a===t[0]&&e===t[1]&&h(u)===h(t[3])?t[2]:u<o.opt.shuffle_attack?t:void 0}}},o.opt.shuffle_attack=15463296e5;var h=Math.floor}))(e,"./index")}()}}]);
//# sourceMappingURL=375.f11c56a7.js.map